<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>core/modules/cdn-media/lib/Bjork/bjork/http/__init.php - wp-flawless</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http://a3d72a45d111006ec192-ec5b80a12b0b09b4d52373336afb4254.r80.cf1.rackcdn.com/usability-dynamics.png" title="wp-flawless"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/API.html">API</a></li>
            
                <li><a href="../classes/Carrington.html">Carrington</a></li>
            
                <li><a href="../classes/Extended_Taxonomies.html">Extended_Taxonomies</a></li>
            
                <li><a href="../classes/Flawless.API.html">Flawless.API</a></li>
            
                <li><a href="../classes/Flawless.Asset.html">Flawless.Asset</a></li>
            
                <li><a href="../classes/Flawless.Branded_Login.html">Flawless.Branded_Login</a></li>
            
                <li><a href="../classes/Flawless.BuddyPress.html">Flawless.BuddyPress</a></li>
            
                <li><a href="../classes/Flawless.Content.html">Flawless.Content</a></li>
            
                <li><a href="../classes/Flawless.Element.html">Flawless.Element</a></li>
            
                <li><a href="../classes/Flawless.Flawless\Shortcode.html">Flawless.Flawless\Shortcode</a></li>
            
                <li><a href="../classes/Flawless.Management.html">Flawless.Management</a></li>
            
                <li><a href="../classes/Flawless.Mobile.html">Flawless.Mobile</a></li>
            
                <li><a href="../classes/Flawless.Navbars.html">Flawless.Navbars</a></li>
            
                <li><a href="../classes/Flawless.Schema.html">Flawless.Schema</a></li>
            
                <li><a href="../classes/Flawless.Settings.html">Flawless.Settings</a></li>
            
                <li><a href="../classes/Flawless.Styles.html">Flawless.Styles</a></li>
            
                <li><a href="../classes/Flawless.Utility.html">Flawless.Utility</a></li>
            
                <li><a href="../classes/Flawless.Widget.html">Flawless.Widget</a></li>
            
                <li><a href="../classes/flawless_wpp_extensions.html">flawless_wpp_extensions</a></li>
            
                <li><a href="../classes/Legacy.html">Legacy</a></li>
            
                <li><a href="../classes/License.html">License</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Log.html">Log</a></li>
            
                <li><a href="../classes/Maintenance.html">Maintenance</a></li>
            
                <li><a href="../classes/Models.html">Models</a></li>
            
                <li><a href="../classes/Module.html">Module</a></li>
            
                <li><a href="../classes/Multisite.html">Multisite</a></li>
            
                <li><a href="../classes/SaaS.html">SaaS</a></li>
            
                <li><a href="../classes/Shortcode.html">Shortcode</a></li>
            
                <li><a href="../classes/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../classes/Template Methods.html">Template Methods</a></li>
            
                <li><a href="../classes/Theme.html">Theme</a></li>
            
                <li><a href="../classes/UI.html">UI</a></li>
            
                <li><a href="../classes/Utility.html">Utility</a></li>
            
                <li><a href="../classes/Views.html">Views</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/API.html">API</a></li>
            
                <li><a href="../modules/Branded Login.html">Branded Login</a></li>
            
                <li><a href="../modules/Carrington.html">Carrington</a></li>
            
                <li><a href="../modules/Carrington Build.html">Carrington Build</a></li>
            
                <li><a href="../modules/carrington-build.html">carrington-build</a></li>
            
                <li><a href="../modules/cfct_build.html">cfct_build</a></li>
            
                <li><a href="../modules/default.html">default</a></li>
            
                <li><a href="../modules/Flawless.html">Flawless</a></li>
            
                <li><a href="../modules/Loader.html">Loader</a></li>
            
                <li><a href="../modules/Log.html">Log</a></li>
            
                <li><a href="../modules/Maintenence.html">Maintenence</a></li>
            
                <li><a href="../modules/Management.html">Management</a></li>
            
                <li><a href="../modules/Multisite.html">Multisite</a></li>
            
                <li><a href="../modules/SaaS.html">SaaS</a></li>
            
                <li><a href="../modules/Services_JSON.html">Services_JSON</a></li>
            
                <li><a href="../modules/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

Released under the GPL license
http:__www.opensource.org_licenses_gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

Released under the GPL license
http://www.opensource.org/licenses/gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/Theme UI.html">Theme UI</a></li>
            
                <li><a href="../modules/UI.html">UI</a></li>
            
                <li><a href="../modules/UsabilityDynamics.html">UsabilityDynamics</a></li>
            
                <li><a href="../modules/Utility.html">Utility</a></li>
            
                <li><a href="../modules/Views.html">Views</a></li>
            
                <li><a href="../modules/WP-Property.html">WP-Property</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: core/modules/cdn-media/lib/Bjork/bjork/http/__init.php</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&lt;?php

namespace bjork\http {

use os,
    os\environ,
    urllib;
use bjork\conf\settings,
    bjork\core\exceptions\BjorkException,
    bjork\core\exceptions\OperationNotSupported,
    bjork\core\signing,
    bjork\core\signing\BadSignature,
    bjork\http,
    bjork\utils\datastructures\Dict,
    bjork\utils\datastructures\List_,
    bjork\utils\datastructures\MultiValueDict,
    bjork\utils\encoding,
    bjork\utils\http as http_utils;

const ABSOLUTE_HTTP_URL_RE = &quot;/^https?:\/\//i&quot;;

class Http404 extends BjorkException {}

class HttpRequest implements \ArrayAccess {
    
    const RAISE_ERROR = &#x27;raise_error_sentinel_1214545&#x27;;
    
    protected
        $_encoding,
        $_method;
    
    var // let those open for patching
        $_path,
        $_pathInfo;
    
    private
        $extraParams;
    
    public function __construct() {
        $this-&gt;_path = &quot;&quot;;
        $this-&gt;_pathInfo = &quot;&quot;;
        $this-&gt;_encoding = &quot;&quot;;
        $this-&gt;_method = null;
        $this-&gt;extraParams = array();
    }
    
    function __toString() {
        return &quot;&lt;&quot;.get_class($this).&quot;: {$this-&gt;getMethod()} {$this-&gt;getPath()}&gt;&quot;;
    }
    
    protected function loadPostAndFiles() {
        // ideally we&#x27;d parse php://input stream that contains
        // the raw post data, but php chose for ourselves to parse
        // the data itself when the submitted form is multipart
        // and leave raw post data empty.
        if (null === $this-&gt;_post) {
            $c = array();
            $r = array_merge(array(), $_POST);
            foreach ($r as $name =&gt; $value)
                $c[$name] = $value;
            $this-&gt;_post = new Dict($c);
        }
        
        if (null === $this-&gt;_files) {
            $files = new MultiValueDict();
            $c = array();
            $r = array_merge(array(), $_FILES);
            foreach ($r as $name =&gt; $array) {
                $files-&gt;setListDefault($name, array());
                // $skip = array();
                // $status = $r[$name][&#x27;error&#x27;];
                // if (!is_array($status))
                //     $status = array($status);
                // foreach ($status as $i =&gt; $st) {
                //     if ($st !== \UPLOAD_ERR_OK)
                //         $skip[] = $i;
                // }
                foreach ($array as $key =&gt; $value) {
                    if (!is_array($value))
                        $value = array($value);
                    $file_list = $files-&gt;getList($name);
                    $index = 0;
                    foreach ($value as $i =&gt; $v) {
                        // if (in_array($i, $skip))
                        //     continue;
                        if (!array_key_exists($i, $file_list))
                            $file_list[$i] = new Dict();
                        $file_list[$i][$key] = $v;
                    }
                    $files-&gt;setList($name, $file_list);
                }
            }
            $this-&gt;_files = $files;
        }
    }
    
    public function offsetExists($k) {
        return array_key_exists($k, $this-&gt;extraParams);
    }
    
    public function offsetGet($k) {
        return $this-&gt;extraParams[$k];
    }
    
    public function offsetSet($k, $value) {
        $this-&gt;extraParams[$k] = $value;
    }
    
    public function offsetUnset($k) {
        unset($this-&gt;extraParams[$k]);
    }
    
    public function get($k, $default=null) {
        return $this-&gt;offsetExists($k)
            ? $this-&gt;offsetGet($k)
            : $default;
    }
    
    public function hasKey($k) {
        return $this-&gt;offsetExists($k);
    }
    
    /**
    * A string representing the full path to the requested page, not
    * including the domain.
    * 
    * Example: &quot;/music/bands/the_beatles/&quot;
    */
    public function getPath() {
        return $this-&gt;_path;
    }
    
    public function getPathInfo() {
        return $this-&gt;_pathInfo;
    }
    
    public function getEncoding() {
        return $this-&gt;_encoding;
    }
    
    public function getMethod() {
        if (!empty($this-&gt;_method))
            return $this-&gt;_method;
        $method = strtoupper(environ::get(&#x27;REQUEST_METHOD&#x27;));
        if (!in_array($method, http::valid_methods())) {
            // Apache accepts anything for REQUEST_METHOD. See this comment:
            // http://www.php.net/manual/en/reserved.variables.server.php#95672
            throw new OperationNotSupported($method);
        }
        $this-&gt;_method = $method;
        return $this-&gt;_method;
    }
    
    /**
    * Returns the HTTP host using the environment or request headers.
    */
    public function getHost() {
        $host = &quot;&quot;;
        
        // We try three options, in order of decreasing preference.
        if (isset($this-&gt;META[&quot;HTTP_X_FORWARDED_HOST&quot;])) {
            $host = $this-&gt;META[&quot;HTTP_X_FORWARDED_HOST&quot;];
        } else if (isset($this-&gt;META[&quot;HTTP_HOST&quot;])) {
            $host = $this-&gt;META[&quot;HTTP_HOST&quot;];
        } else {
            // Reconstruct the host.
            $host = $this-&gt;META[&quot;SERVER_NAME&quot;];
            $port = $this-&gt;META[&quot;SERVER_PORT&quot;];
            if ($port != ($this-&gt;isSecure() ? &quot;443&quot; : &quot;80&quot;))
                $host .= &quot;:&quot;.$port;
        }
        return $host;
    }
    
    public function getFullPath() {
        $qs = isset($this-&gt;META[&quot;QUERY_STRING&quot;])
            ? $this-&gt;META[&quot;QUERY_STRING&quot;]
            : &quot;&quot;;
        
        // RFC 3986 requires query string arguments to be in the ASCII range.
        // Rather than crash if this doesn&#x27;t happen, we encode defensively.
        return sprintf(&#x27;%s%s&#x27;, $this-&gt;_path, !empty($qs)
            ? &#x27;?&#x27;.encoding::iri_to_uri($qs)
            : &#x27;&#x27;);
    }
    
    /**
    * Builds an absolute URI from the location and the variables available 
    * in this request. If no location is specified, the absolute URI is built
    * on &#x60;&#x60;request.get_full_path()&#x60;&#x60;.
    */
    public function buildAbsoluteURI($location=null) {
        if (empty($location))
            $location = $this-&gt;getFullPath();
        if (!preg_match(ABSOLUTE_HTTP_URL_RE, $location)) {
            $currentURI = sprintf(&quot;%s://%s%s&quot;,
                $this-&gt;isSecure() ? &quot;https&quot; : &quot;http&quot;,
                $this-&gt;getHost(),
                $this-&gt;getPath());
            $location = urllib::join($currentURI, $location);
        }
        return encoding::iri_to_uri($location);
    }
    
    public function isSecure() {
        $https = environ::get(&quot;HTTPS&quot;, &quot;&quot;);
        return $https == &quot;on&quot; || $https == &quot;1&quot;;
    }
    
    public function isAjax() {
        return &quot;XMLHttpRequest&quot; === (isset($this-&gt;META[&quot;HTTP_X_REQUESTED_WITH&quot;])
            ? $this-&gt;META[&quot;HTTP_X_REQUESTED_WITH&quot;]
            : &quot;&quot;);
    }
    
    /**
    * Attempts to return a signed cookie. If the signature fails or the
    * cookie has expired, raises an exception... unless you provide the
    * default argument in which case that value will be returned instead.
    */
    public function getSignedCookie($key, $default=self::RAISE_ERROR, $salt=&#x27;&#x27;, $max_age=null) {
        if (!$this-&gt;COOKIES-&gt;hasKey($key)) {
            if ($default !== self::RAISE_ERROR)
                return $default;
            else
                throw new \OutOfBoundsException($key);
        }
        
        $cookie_value = $this-&gt;COOKIES[$key];
        $signer = signing::get_cookie_signer($key . $salt);
        
        try {
            $value = $signer-&gt;unsign($cookie_value, $max_age);
        } catch (BadSignature $e) {
            if ($default !== self::RAISE_ERROR)
                return $default;
            else
                throw $e;
        }
        
        return $value;
    }
}

/**
* A specialized MultiValueDict that takes a query string when initialized.
* This is immutable unless you create a copy of it.
* 
* Values retrieved from this class are converted from the given encoding
* (DEFAULT_CHARSET by default) to unicode.
*/
class QueryDict extends MultiValueDict {
    public $encoding;
    
    protected $_mutable = true;
    
    function __construct($queryString, $mutable=false, $encoding=null) {
        parent::__construct();
        if (empty($encoding))
            $encoding = settings::get(&quot;DEFAULT_CHARSET&quot;);
        if (empty($queryString))
            $queryString = &quot;&quot;;
        $qs = urllib::parse_qsl($queryString, true); // $keepBlankValues=true
        foreach ($qs as $entry)
            $this-&gt;appendList(encoding::to_unicode($entry[0], $encoding),
                              encoding::to_unicode($entry[1], $encoding));
        $this-&gt;encoding = $encoding;
        $this-&gt;_mutable = $mutable;
    }
    
    private function assertMutable() {
        if (!$this-&gt;_mutable)
            throw new \BadMethodCallException(
                &quot;This &quot;.__CLASS__.&quot; instance is immutable&quot;);
    }
    
    public function offsetSet($k, $value) {
        $this-&gt;assertMutable();
        parent::offsetSet($k, $value);
    }
    
    public function offsetUnset($k) {
        $this-&gt;assertMutable();
        parent::offsetUnset($k);
    }
    
    public function setList($k, array $list) {
        $this-&gt;assertMutable();
        parent::setList($k, $list);
    }
    
    public function appendList($k, $value) {
        $this-&gt;assertMutable();
        parent::appendList($k, $value);
    }
    
    /**
    * Returns an encoded string of all query string arguments.
    * 
    *   &gt;&gt;&gt; q = new QueryDict(&#x27;&#x27;, true)
    *   &gt;&gt;&gt; q[&#x27;next&#x27;] = &#x27;/a&amp;b/&#x27;
    *   &gt;&gt;&gt; q-&gt;urlencode()
    *   &#x27;next=%2Fa%26b%2F&#x27;
    *   &gt;&gt;&gt; q-&gt;urlencode(&#x27;/&#x27;)
    *   &#x27;next=/a%26b/&#x27;
    */
    public function urlencode($safe=null) {
        $output = array();
        if (null !== $safe) {
            $encode = function($k, $v) use ($safe) {
                return sprintf(&#x27;%s=%s&#x27;, urllib::quote($k, $safe), urllib::quote($v, $safe)); };
            $encode_list = function($k, $v) use ($safe) {
                return sprintf(&#x27;%s[]=%s&#x27;, urllib::quote($k, $safe), urllib::quote($v, $safe)); };
        } else {
            $encode = function($k, $v) use ($safe) {
                return sprintf(&#x27;%s=%s&#x27;, urlencode($k), urlencode($v)); };
            $encode_list = function($k, $v) use ($safe) {
                return sprintf(&#x27;%s[]=%s&#x27;, urlencode($k), urlencode($v)); };
        }
        foreach ($this-&gt;getLists() as $k =&gt; $list) {
            if (count($list) === 1)
                $output[] = $encode($k, $list[0]);
            else {
                foreach ($arr as $v)
                    $output[] = $encode_list($k, $v);
            }
        }
        return implode(&#x27;&amp;&#x27;, $output);
    }
}

class BadHeaderError extends BjorkException {}

class HttpResponse implements \ArrayAccess {
    public
        $statusCode = 200;
    
    protected
        $_headers,
        $_attrs,
        $_cookies,
        $_charset,
        $_container,
        $_isString;
    
    function __construct($content=&quot;&quot;, $contentType=null, $status=null) {
        // _headers is a mapping of the lower-case name to the original case
        // of the header (required for working with legacy systems) and the
        // header value. Both the name of the header and its value are ASCII
        // strings.
        $this-&gt;_headers = array();
        $this-&gt;_attrs = array();
        $this-&gt;_charset = settings::get(&quot;DEFAULT_CHARSET&quot;);
        if (!is_null($status))
            $this-&gt;statusCode = $status;
        if (is_null($contentType))
            $contentType = sprintf(&quot;%s; charset=%s&quot;,
                settings::get(&quot;DEFAULT_CONTENT_TYPE&quot;),
                $this-&gt;_charset);
        if (is_string($content)) {
            $this-&gt;_container = array($content);
            $this-&gt;_isString = true;
        } else {
            $this-&gt;_container = $content;
            $this-&gt;_isString = false;
        }
        $this[&quot;Content-Type&quot;] = $contentType;
        
        $this-&gt;_cookies = array();
    }
    
    /**
    * Full HTTP message, including headers.
    */
    function __toString() {
        return $this-&gt;toString();
    }
    
    function toString() {
        ob_implicit_flush(false);
        
        ob_start();
        
        foreach ($this-&gt;_cookies as $name =&gt; $c)
            setcookie($name,
                $c[&#x27;value&#x27;], $c[&#x27;expires&#x27;], $c[&#x27;path&#x27;],
                $c[&#x27;domain&#x27;], $c[&#x27;secure&#x27;], $c[&#x27;httponly&#x27;]);
        
        foreach ($this-&gt;_headers as $header)
            header(&quot;{$header[0]}: {$header[1]}&quot;);
        
        print $this-&gt;getContent();
        
        $content = ob_get_clean();
        
        return $content;
    }
    
    //-- headers
    
    public function offsetExists($header) {
        return array_key_exists(strtolower($header), $this-&gt;_headers);
    }
    
    public function offsetGet($header) {
        return $this-&gt;_headers[strtolower($header)][1];
    }
    
    public function offsetSet($header, $value) {
        list($header, $value) = $this-&gt;_convertToASCII($header, $value);
        $this-&gt;_headers[strtolower($header)] = array($header, $value);
    }
    
    public function offsetUnset($header) {
        unset($this-&gt;_headers[strtolower($header)]);
    }
    
    //-- runtime attributes
    
    public function hasAttribute($name) {
        return array_key_exists($name, $this-&gt;_attrs);
    }
    
    public function getAttribute($name/*, $default*/) {
        if (array_key_exists($name, $this-&gt;_attrs))
            return $this-&gt;_attrs[$name];
        $args = func_get_args();
        if (count($args) &gt; 1)
            return $args[1];
        throw new \OutOfBoundsException($name);
    }
    
    public function setAttribute($name, $value) {
        $this-&gt;_attrs[$name] = $value;
    }
    
    //-- cookies
    
    public function setSignedCookie($key, $value, $salt=&#x27;&#x27;, array $options=null) {
        $value = signing::get_cookie_signer($key . $salt)-&gt;sign($value);
        $this-&gt;setCookie($key, $value, $options);
    }
    
    /**
    * Sets a cookie.
    *
    * &#x60;&#x60;expires&#x60;&#x60; can be a string in the correct format or a &#x60;&#x60;DateTime&#x60;&#x60;
    * object in UTC. If &#x60;&#x60;expires&#x60;&#x60; is a DateTime object then &#x60;&#x60;max_age&#x60;&#x60;
    * will be calculated.
    */
    public function setCookie($key, $value=&#x27;&#x27;, array $options=null) {
        if (null === $options)
            $options = array();
        
        $defaults = array(
            &#x27;max_age&#x27;   =&gt; null,
            &#x27;expires&#x27;   =&gt; null,
            &#x27;domain&#x27;    =&gt; null,
            &#x27;path&#x27;      =&gt; &#x27;/&#x27;,
            &#x27;secure&#x27;    =&gt; false,
            &#x27;httponly&#x27;  =&gt; false
        );
        
        extract(array_merge($defaults, $options));
        
        $cookie = array(
            &#x27;value&#x27;     =&gt; $value,
            &#x27;expires&#x27;   =&gt; 0,
            &#x27;domain&#x27;    =&gt; &#x27;&#x27;,
            &#x27;path&#x27;      =&gt; &#x27;&#x27;,
            &#x27;secure&#x27;    =&gt; false,
            &#x27;httponly&#x27;  =&gt; false,
        );
        
        if (null !== $expires) {
            if ($expires instanceof \DateTime) {
                $utcnow = new \DateTime(null, new \DateTimeZone(\DateTimeZone::UTC));
                $delta = $expires-&gt;diff($utcnow);
                $max_age = max(0,
                    $delta-&gt;days * 86400 +
                    $delta-&gt;h * 24 +
                    $delta-&gt;m * 60 +
                    $delta-&gt;s);
            } else if ($expires === 0) {
                // passing 0 will tell php to make the cookie expire at browser
                // close, which is not what we ment...
                $cookie[&#x27;expires&#x27;] = time() - 86400; // yesterday
            } else {
                $cookie[&#x27;expires&#x27;] = $expires;
            }
        }
        
        if (null !== $max_age) {
            if (!isset($cookie[&#x27;expires&#x27;]))
                $cookie[&#x27;expires&#x27;] = time() + $max_age;
        }
        
        if (null !== $path)
            $cookie[&#x27;path&#x27;] = $path;
        
        if (null !== $domain)
            $cookie[&#x27;domain&#x27;] = $domain;
        
        if ($secure)
            $cookie[&#x27;secure&#x27;] = true;
        
        if ($httponly)
            $cookie[&#x27;httponly&#x27;] = true;
        
        $this-&gt;_cookies[$key] = $cookie;
    }
    
    public function deleteCookie($key, $path=&#x27;/&#x27;, $domain=null) {
        $this-&gt;setCookie($key, &#x27;&#x27;, array(
            &#x27;expires&#x27; =&gt; 0,
            &#x27;path&#x27; =&gt; $path,
            &#x27;domain&#x27; =&gt; $domain,
        ));
    }
    
    protected function _convertToASCII(/*arg, ...*/) {
        $values = func_get_args();
        $headers = array();
        foreach ($values as $value) {
            if (encoding::is_unicode($value))
                $value = encoding::to_str($value, &quot;utf-8&quot;);
            else
                $value = encoding::to_str($value, null); // use internal encoding
            if (0 !== preg_match(&quot;/[\r\n]+/s&quot;, $value))
                throw new BadHeaderError(
                    &quot;Header values can&#x27;t contain newlines (got {$value})&quot;);
            $headers[] = $value;
        }
        return $headers;
    }
    
    //-- content
    
    public function getContent() {
        $content = implode(&quot;&quot;, $this-&gt;_container);
        if (isset($this[&quot;Content-Encoding&quot;]))
            return $content;
        return encoding::to_str($content, $this-&gt;_charset);
    }
    
    public function setContent($value) {
        $this-&gt;_container = array($value);
        $this-&gt;_isString = true;
    }
    
    public function write($content) {
        if (!$this-&gt;_isString)
            throw new \Exception(&quot;This &quot;.__CLASS__.&quot; instance is not writable.&quot;);
        $this-&gt;_container[] = $content;
    }
    
    public function close() {
        if (method_exists($this-&gt;_container, &quot;close&quot;))
            $this-&gt;_container-&gt;close();
    }
}

class HttpResponseRedirect extends HttpResponse {
    public $statusCode = 302;

    function __construct($redirectTo) {
        parent::__construct();
        $this[&#x27;Location&#x27;] = encoding::iri_to_uri($redirectTo);
    }
}

class HttpResponsePermanentRedirect extends HttpResponse {
    public $statusCode = 301;

    function __construct($redirectTo) {
        parent::__construct();
        $this[&#x27;Location&#x27;] = encoding::iri_to_uri($redirectTo);
    }
}

class HttpResponseNotModified extends HttpResponse {
    public $statusCode = 304;
}

class HttpResponseBadRequest extends HttpResponse {
    public $statusCode = 400;
}

class HttpResponseNotFound extends HttpResponse {
    public $statusCode = 404;
}

class HttpResponseForbidden extends HttpResponse {
    public $statusCode = 403;
}

class HttpResponseNotAllowed extends HttpResponse {
    public $statusCode = 405;
    function __construct($permittedMethods) {
        parent::__construct();
        $this[&#x27;Allow&#x27;] = implode(&quot;, &quot;, $permittedMethods);
    }
}

class HttpResponseGone extends HttpResponse {
    public $statusCode = 410;
}

class HttpResponseServerError extends HttpResponse {
    public $statusCode = 500;
}

}

namespace bjork {

final class http {
    /**
    * Return a list of strings for the valid HTTP/1.1 request
    * methods (RFC2616).
    * 
    * http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html
    */
    public static function valid_methods() {
        return array(
            &quot;GET&quot;, &quot;HEAD&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;,
            &quot;TRACE&quot;, &quot;OPTIONS&quot;, &quot;CONNECT&quot;,
        );
    }
}

}

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>

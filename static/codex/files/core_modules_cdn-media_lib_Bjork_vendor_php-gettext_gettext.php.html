<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>core/modules/cdn-media/lib/Bjork/vendor/php-gettext/gettext.php - wp-flawless</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http://a3d72a45d111006ec192-ec5b80a12b0b09b4d52373336afb4254.r80.cf1.rackcdn.com/usability-dynamics.png" title="wp-flawless"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/API.html">API</a></li>
            
                <li><a href="../classes/Carrington.html">Carrington</a></li>
            
                <li><a href="../classes/Extended_Taxonomies.html">Extended_Taxonomies</a></li>
            
                <li><a href="../classes/Flawless.API.html">Flawless.API</a></li>
            
                <li><a href="../classes/Flawless.Asset.html">Flawless.Asset</a></li>
            
                <li><a href="../classes/Flawless.Branded_Login.html">Flawless.Branded_Login</a></li>
            
                <li><a href="../classes/Flawless.BuddyPress.html">Flawless.BuddyPress</a></li>
            
                <li><a href="../classes/Flawless.Content.html">Flawless.Content</a></li>
            
                <li><a href="../classes/Flawless.Element.html">Flawless.Element</a></li>
            
                <li><a href="../classes/Flawless.Flawless\Shortcode.html">Flawless.Flawless\Shortcode</a></li>
            
                <li><a href="../classes/Flawless.Management.html">Flawless.Management</a></li>
            
                <li><a href="../classes/Flawless.Mobile.html">Flawless.Mobile</a></li>
            
                <li><a href="../classes/Flawless.Navbars.html">Flawless.Navbars</a></li>
            
                <li><a href="../classes/Flawless.Schema.html">Flawless.Schema</a></li>
            
                <li><a href="../classes/Flawless.Settings.html">Flawless.Settings</a></li>
            
                <li><a href="../classes/Flawless.Styles.html">Flawless.Styles</a></li>
            
                <li><a href="../classes/Flawless.Utility.html">Flawless.Utility</a></li>
            
                <li><a href="../classes/Flawless.Widget.html">Flawless.Widget</a></li>
            
                <li><a href="../classes/flawless_wpp_extensions.html">flawless_wpp_extensions</a></li>
            
                <li><a href="../classes/Legacy.html">Legacy</a></li>
            
                <li><a href="../classes/License.html">License</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Log.html">Log</a></li>
            
                <li><a href="../classes/Maintenance.html">Maintenance</a></li>
            
                <li><a href="../classes/Models.html">Models</a></li>
            
                <li><a href="../classes/Module.html">Module</a></li>
            
                <li><a href="../classes/Multisite.html">Multisite</a></li>
            
                <li><a href="../classes/SaaS.html">SaaS</a></li>
            
                <li><a href="../classes/Shortcode.html">Shortcode</a></li>
            
                <li><a href="../classes/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../classes/Template Methods.html">Template Methods</a></li>
            
                <li><a href="../classes/Theme.html">Theme</a></li>
            
                <li><a href="../classes/UI.html">UI</a></li>
            
                <li><a href="../classes/Utility.html">Utility</a></li>
            
                <li><a href="../classes/Views.html">Views</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/API.html">API</a></li>
            
                <li><a href="../modules/Branded Login.html">Branded Login</a></li>
            
                <li><a href="../modules/Carrington.html">Carrington</a></li>
            
                <li><a href="../modules/Carrington Build.html">Carrington Build</a></li>
            
                <li><a href="../modules/carrington-build.html">carrington-build</a></li>
            
                <li><a href="../modules/cfct_build.html">cfct_build</a></li>
            
                <li><a href="../modules/default.html">default</a></li>
            
                <li><a href="../modules/Flawless.html">Flawless</a></li>
            
                <li><a href="../modules/Loader.html">Loader</a></li>
            
                <li><a href="../modules/Log.html">Log</a></li>
            
                <li><a href="../modules/Maintenence.html">Maintenence</a></li>
            
                <li><a href="../modules/Management.html">Management</a></li>
            
                <li><a href="../modules/Multisite.html">Multisite</a></li>
            
                <li><a href="../modules/SaaS.html">SaaS</a></li>
            
                <li><a href="../modules/Services_JSON.html">Services_JSON</a></li>
            
                <li><a href="../modules/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

Released under the GPL license
http:__www.opensource.org_licenses_gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

Released under the GPL license
http://www.opensource.org/licenses/gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/Theme UI.html">Theme UI</a></li>
            
                <li><a href="../modules/UI.html">UI</a></li>
            
                <li><a href="../modules/UsabilityDynamics.html">UsabilityDynamics</a></li>
            
                <li><a href="../modules/Utility.html">Utility</a></li>
            
                <li><a href="../modules/Views.html">Views</a></li>
            
                <li><a href="../modules/WP-Property.html">WP-Property</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: core/modules/cdn-media/lib/Bjork/vendor/php-gettext/gettext.php</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&lt;?php
/*
   Copyright (c) 2003, 2009 Danilo Segan &lt;danilo@kvota.net&gt;.
   Copyright (c) 2005 Nico Kaiser &lt;nico@siriux.net&gt;

   This file is part of PHP-gettext.

   PHP-gettext is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 2 of the License, or
   (at your option) any later version.

   PHP-gettext is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with PHP-gettext; if not, write to the Free Software
   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

*/

/**
 * Provides a simple gettext replacement that works independently from
 * the system&#x27;s gettext abilities.
 * It can read MO files and use them for translating strings.
 * The files are passed to gettext_reader as a Stream (see streams.php)
 *
 * This version has the ability to cache all strings and translations to
 * speed up the string lookup.
 * While the cache is enabled by default, it can be switched off with the
 * second parameter in the constructor (e.g. whenusing very large MO files
 * that you don&#x27;t want to keep in memory)
 */
class gettext_reader {
  //public:
   var $error = 0; // public variable that holds error code (0 if no error)

   //private:
  var $BYTEORDER = 0;        // 0: low endian, 1: big endian
  var $STREAM = NULL;
  var $short_circuit = false;
  var $enable_cache = false;
  var $originals = NULL;      // offset of original table
  var $translations = NULL;    // offset of translation table
  var $pluralheader = NULL;    // cache header field for plural forms
  var $total = 0;          // total string count
  var $table_originals = NULL;  // table for original strings (offsets)
  var $table_translations = NULL;  // table for translated strings (offsets)
  var $cache_translations = NULL;  // original -&gt; translation mapping


  /* Methods */


  /**
   * Reads a 32bit Integer from the Stream
   *
   * @access private
   * @return Integer from the Stream
   */
  function readint() {
      if ($this-&gt;BYTEORDER == 0) {
        // low endian
        $input=unpack(&#x27;V&#x27;, $this-&gt;STREAM-&gt;read(4));
        return array_shift($input);
      } else {
        // big endian
        $input=unpack(&#x27;N&#x27;, $this-&gt;STREAM-&gt;read(4));
        return array_shift($input);
      }
    }

  function read($bytes) {
    return $this-&gt;STREAM-&gt;read($bytes);
  }

  /**
   * Reads an array of Integers from the Stream
   *
   * @param int count How many elements should be read
   * @return Array of Integers
   */
  function readintarray($count) {
    if ($this-&gt;BYTEORDER == 0) {
        // low endian
        return unpack(&#x27;V&#x27;.$count, $this-&gt;STREAM-&gt;read(4 * $count));
      } else {
        // big endian
        return unpack(&#x27;N&#x27;.$count, $this-&gt;STREAM-&gt;read(4 * $count));
      }
  }

  /**
   * Constructor
   *
   * @param object Reader the StreamReader object
   * @param boolean enable_cache Enable or disable caching of strings (default on)
   */
  function gettext_reader($Reader, $enable_cache = true) {
    // If there isn&#x27;t a StreamReader, turn on short circuit mode.
    if (! $Reader || isset($Reader-&gt;error) ) {
      $this-&gt;short_circuit = true;
      return;
    }

    // Caching can be turned off
    $this-&gt;enable_cache = $enable_cache;

    $MAGIC1 = &quot;\x95\x04\x12\xde&quot;;
    $MAGIC2 = &quot;\xde\x12\x04\x95&quot;;

    $this-&gt;STREAM = $Reader;
    $magic = $this-&gt;read(4);
    if ($magic == $MAGIC1) {
      $this-&gt;BYTEORDER = 1;
    } elseif ($magic == $MAGIC2) {
      $this-&gt;BYTEORDER = 0;
    } else {
      $this-&gt;error = 1; // not MO file
      return false;
    }

    // FIXME: Do we care about revision? We should.
    $revision = $this-&gt;readint();

    $this-&gt;total = $this-&gt;readint();
    $this-&gt;originals = $this-&gt;readint();
    $this-&gt;translations = $this-&gt;readint();
  }

  /**
   * Loads the translation tables from the MO file into the cache
   * If caching is enabled, also loads all strings into a cache
   * to speed up translation lookups
   *
   * @access private
   */
  function load_tables() {
    if (is_array($this-&gt;cache_translations) &amp;&amp;
      is_array($this-&gt;table_originals) &amp;&amp;
      is_array($this-&gt;table_translations))
      return;

    /* get original and translations tables */
    if (!is_array($this-&gt;table_originals)) {
      $this-&gt;STREAM-&gt;seekto($this-&gt;originals);
      $this-&gt;table_originals = $this-&gt;readintarray($this-&gt;total * 2);
    }
    if (!is_array($this-&gt;table_translations)) {
      $this-&gt;STREAM-&gt;seekto($this-&gt;translations);
      $this-&gt;table_translations = $this-&gt;readintarray($this-&gt;total * 2);
    }

    if ($this-&gt;enable_cache) {
      $this-&gt;cache_translations = array ();
      /* read all strings in the cache */
      for ($i = 0; $i &lt; $this-&gt;total; $i++) {
        $this-&gt;STREAM-&gt;seekto($this-&gt;table_originals[$i * 2 + 2]);
        $original = $this-&gt;STREAM-&gt;read($this-&gt;table_originals[$i * 2 + 1]);
        $this-&gt;STREAM-&gt;seekto($this-&gt;table_translations[$i * 2 + 2]);
        $translation = $this-&gt;STREAM-&gt;read($this-&gt;table_translations[$i * 2 + 1]);
        $this-&gt;cache_translations[$original] = $translation;
      }
    }
  }

  /**
   * Returns a string from the &quot;originals&quot; table
   *
   * @access private
   * @param int num Offset number of original string
   * @return string Requested string if found, otherwise &#x27;&#x27;
   */
  function get_original_string($num) {
    $length = $this-&gt;table_originals[$num * 2 + 1];
    $offset = $this-&gt;table_originals[$num * 2 + 2];
    if (! $length)
      return &#x27;&#x27;;
    $this-&gt;STREAM-&gt;seekto($offset);
    $data = $this-&gt;STREAM-&gt;read($length);
    return (string)$data;
  }

  /**
   * Returns a string from the &quot;translations&quot; table
   *
   * @access private
   * @param int num Offset number of original string
   * @return string Requested string if found, otherwise &#x27;&#x27;
   */
  function get_translation_string($num) {
    $length = $this-&gt;table_translations[$num * 2 + 1];
    $offset = $this-&gt;table_translations[$num * 2 + 2];
    if (! $length)
      return &#x27;&#x27;;
    $this-&gt;STREAM-&gt;seekto($offset);
    $data = $this-&gt;STREAM-&gt;read($length);
    return (string)$data;
  }

  /**
   * Binary search for string
   *
   * @access private
   * @param string string
   * @param int start (internally used in recursive function)
   * @param int end (internally used in recursive function)
   * @return int string number (offset in originals table)
   */
  function find_string($string, $start = -1, $end = -1) {
    if (($start == -1) or ($end == -1)) {
      // find_string is called with only one parameter, set start end end
      $start = 0;
      $end = $this-&gt;total;
    }
    if (abs($start - $end) &lt;= 1) {
      // We&#x27;re done, now we either found the string, or it doesn&#x27;t exist
      $txt = $this-&gt;get_original_string($start);
      if ($string == $txt)
        return $start;
      else
        return -1;
    } else if ($start &gt; $end) {
      // start &gt; end -&gt; turn around and start over
      return $this-&gt;find_string($string, $end, $start);
    } else {
      // Divide table in two parts
      $half = (int)(($start + $end) / 2);
      $cmp = strcmp($string, $this-&gt;get_original_string($half));
      if ($cmp == 0)
        // string is exactly in the middle =&gt; return it
        return $half;
      else if ($cmp &lt; 0)
        // The string is in the upper half
        return $this-&gt;find_string($string, $start, $half);
      else
        // The string is in the lower half
        return $this-&gt;find_string($string, $half, $end);
    }
  }

  /**
   * Translates a string
   *
   * @access public
   * @param string string to be translated
   * @return string translated string (or original, if not found)
   */
  function translate($string) {
    if ($this-&gt;short_circuit)
      return $string;
    $this-&gt;load_tables();

    if ($this-&gt;enable_cache) {
      // Caching enabled, get translated string from cache
      if (array_key_exists($string, $this-&gt;cache_translations))
        return $this-&gt;cache_translations[$string];
      else
        return $string;
    } else {
      // Caching not enabled, try to find string
      $num = $this-&gt;find_string($string);
      if ($num == -1)
        return $string;
      else
        return $this-&gt;get_translation_string($num);
    }
  }

  /**
   * Sanitize plural form expression for use in PHP eval call.
   *
   * @access private
   * @return string sanitized plural form expression
   */
  function sanitize_plural_expression($expr) {
    // Get rid of disallowed characters.
    $expr = preg_replace(&#x27;@[^a-zA-Z0-9_:;\(\)\?\|\&amp;=!&lt;&gt;+*/\%-]@&#x27;, &#x27;&#x27;, $expr);

    // Add parenthesis for tertiary &#x27;?&#x27; operator.
    $expr .= &#x27;;&#x27;;
    $res = &#x27;&#x27;;
    $p = 0;
    for ($i = 0; $i &lt; strlen($expr); $i++) {
      $ch = $expr[$i];
      switch ($ch) {
      case &#x27;?&#x27;:
        $res .= &#x27; ? (&#x27;;
        $p++;
        break;
      case &#x27;:&#x27;:
        $res .= &#x27;) : (&#x27;;
        break;
      case &#x27;;&#x27;:
        $res .= str_repeat( &#x27;)&#x27;, $p) . &#x27;;&#x27;;
        $p = 0;
        break;
      default:
        $res .= $ch;
      }
    }
    return $res;
  }

  /**
   * Parse full PO header and extract only plural forms line.
   *
   * @access private
   * @return string verbatim plural form header field
   */
  function extract_plural_forms_header_from_po_header($header) {
    if (preg_match(&quot;/(^|\n)plural-forms: ([^\n]*)\n/i&quot;, $header, $regs))
      $expr = $regs[2];
    else
      $expr = &quot;nplurals=2; plural=n == 1 ? 0 : 1;&quot;;
    return $expr;
  }

  /**
   * Get possible plural forms from MO header
   *
   * @access private
   * @return string plural form header
   */
  function get_plural_forms() {
    // lets assume message number 0 is header
    // this is true, right?
    $this-&gt;load_tables();

    // cache header field for plural forms
    if (! is_string($this-&gt;pluralheader)) {
      if ($this-&gt;enable_cache) {
        $header = $this-&gt;cache_translations[&quot;&quot;];
      } else {
        $header = $this-&gt;get_translation_string(0);
      }
      $expr = $this-&gt;extract_plural_forms_header_from_po_header($header);
      $this-&gt;pluralheader = $this-&gt;sanitize_plural_expression($expr);
    }
    return $this-&gt;pluralheader;
  }

  /**
   * Detects which plural form to take
   *
   * @access private
   * @param n count
   * @return int array index of the right plural form
   */
  function select_string($n) {
    $string = $this-&gt;get_plural_forms();
    $string = str_replace(&#x27;nplurals&#x27;,&quot;\$total&quot;,$string);
    $string = str_replace(&quot;n&quot;,$n,$string);
    $string = str_replace(&#x27;plural&#x27;,&quot;\$plural&quot;,$string);

    $total = 0;
    $plural = 0;

    eval(&quot;$string&quot;);
    if ($plural &gt;= $total) $plural = $total - 1;
    return $plural;
  }

  /**
   * Plural version of gettext
   *
   * @access public
   * @param string single
   * @param string plural
   * @param string number
   * @return translated plural form
   */
  function ngettext($single, $plural, $number) {
    if ($this-&gt;short_circuit) {
      if ($number != 1)
        return $plural;
      else
        return $single;
    }

    // find out the appropriate form
    $select = $this-&gt;select_string($number);

    // this should contains all strings separated by NULLs
    $key = $single . chr(0) . $plural;


    if ($this-&gt;enable_cache) {
      if (! array_key_exists($key, $this-&gt;cache_translations)) {
        return ($number != 1) ? $plural : $single;
      } else {
        $result = $this-&gt;cache_translations[$key];
        $list = explode(chr(0), $result);
        return $list[$select];
      }
    } else {
      $num = $this-&gt;find_string($key);
      if ($num == -1) {
        return ($number != 1) ? $plural : $single;
      } else {
        $result = $this-&gt;get_translation_string($num);
        $list = explode(chr(0), $result);
        return $list[$select];
      }
    }
  }

  function pgettext($context, $msgid) {
    $key = $context . chr(4) . $msgid;
    $ret = $this-&gt;translate($key);
    if (strpos($ret, &quot;\004&quot;) !== FALSE) {
      return $msgid;
    } else {
      return $ret;
    }
  }

  function npgettext($context, $singular, $plural, $number) {
    $key = $context . chr(4) . $singular;
    $ret = $this-&gt;ngettext($key, $plural, $number);
    if (strpos($ret, &quot;\004&quot;) !== FALSE) {
      return $singular;
    } else {
      return $ret;
    }

  }
}

?&gt;

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>

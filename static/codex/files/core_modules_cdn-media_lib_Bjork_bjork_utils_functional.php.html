<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>core/modules/cdn-media/lib/Bjork/bjork/utils/functional.php - wp-flawless</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http://a3d72a45d111006ec192-ec5b80a12b0b09b4d52373336afb4254.r80.cf1.rackcdn.com/usability-dynamics.png" title="wp-flawless"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/API.html">API</a></li>
            
                <li><a href="../classes/Carrington.html">Carrington</a></li>
            
                <li><a href="../classes/Extended_Taxonomies.html">Extended_Taxonomies</a></li>
            
                <li><a href="../classes/Flawless.API.html">Flawless.API</a></li>
            
                <li><a href="../classes/Flawless.Asset.html">Flawless.Asset</a></li>
            
                <li><a href="../classes/Flawless.Branded_Login.html">Flawless.Branded_Login</a></li>
            
                <li><a href="../classes/Flawless.BuddyPress.html">Flawless.BuddyPress</a></li>
            
                <li><a href="../classes/Flawless.Content.html">Flawless.Content</a></li>
            
                <li><a href="../classes/Flawless.Element.html">Flawless.Element</a></li>
            
                <li><a href="../classes/Flawless.Flawless\Shortcode.html">Flawless.Flawless\Shortcode</a></li>
            
                <li><a href="../classes/Flawless.Management.html">Flawless.Management</a></li>
            
                <li><a href="../classes/Flawless.Mobile.html">Flawless.Mobile</a></li>
            
                <li><a href="../classes/Flawless.Navbars.html">Flawless.Navbars</a></li>
            
                <li><a href="../classes/Flawless.Schema.html">Flawless.Schema</a></li>
            
                <li><a href="../classes/Flawless.Settings.html">Flawless.Settings</a></li>
            
                <li><a href="../classes/Flawless.Styles.html">Flawless.Styles</a></li>
            
                <li><a href="../classes/Flawless.Utility.html">Flawless.Utility</a></li>
            
                <li><a href="../classes/Flawless.Widget.html">Flawless.Widget</a></li>
            
                <li><a href="../classes/flawless_wpp_extensions.html">flawless_wpp_extensions</a></li>
            
                <li><a href="../classes/Legacy.html">Legacy</a></li>
            
                <li><a href="../classes/License.html">License</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Log.html">Log</a></li>
            
                <li><a href="../classes/Maintenance.html">Maintenance</a></li>
            
                <li><a href="../classes/Models.html">Models</a></li>
            
                <li><a href="../classes/Module.html">Module</a></li>
            
                <li><a href="../classes/Multisite.html">Multisite</a></li>
            
                <li><a href="../classes/SaaS.html">SaaS</a></li>
            
                <li><a href="../classes/Shortcode.html">Shortcode</a></li>
            
                <li><a href="../classes/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../classes/Template Methods.html">Template Methods</a></li>
            
                <li><a href="../classes/Theme.html">Theme</a></li>
            
                <li><a href="../classes/UI.html">UI</a></li>
            
                <li><a href="../classes/Utility.html">Utility</a></li>
            
                <li><a href="../classes/Views.html">Views</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/API.html">API</a></li>
            
                <li><a href="../modules/Branded Login.html">Branded Login</a></li>
            
                <li><a href="../modules/Carrington.html">Carrington</a></li>
            
                <li><a href="../modules/Carrington Build.html">Carrington Build</a></li>
            
                <li><a href="../modules/carrington-build.html">carrington-build</a></li>
            
                <li><a href="../modules/cfct_build.html">cfct_build</a></li>
            
                <li><a href="../modules/default.html">default</a></li>
            
                <li><a href="../modules/Flawless.html">Flawless</a></li>
            
                <li><a href="../modules/Loader.html">Loader</a></li>
            
                <li><a href="../modules/Log.html">Log</a></li>
            
                <li><a href="../modules/Maintenence.html">Maintenence</a></li>
            
                <li><a href="../modules/Management.html">Management</a></li>
            
                <li><a href="../modules/Multisite.html">Multisite</a></li>
            
                <li><a href="../modules/SaaS.html">SaaS</a></li>
            
                <li><a href="../modules/Services_JSON.html">Services_JSON</a></li>
            
                <li><a href="../modules/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

Released under the GPL license
http:__www.opensource.org_licenses_gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

Released under the GPL license
http://www.opensource.org/licenses/gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/Theme UI.html">Theme UI</a></li>
            
                <li><a href="../modules/UI.html">UI</a></li>
            
                <li><a href="../modules/UsabilityDynamics.html">UsabilityDynamics</a></li>
            
                <li><a href="../modules/Utility.html">Utility</a></li>
            
                <li><a href="../modules/Views.html">Views</a></li>
            
                <li><a href="../modules/WP-Property.html">WP-Property</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: core/modules/cdn-media/lib/Bjork/bjork/utils/functional.php</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&lt;?php

namespace bjork\utils {

use bjork\utils\functional\ContextManager;

final class functional {
    
    /**
    * Call a user function using named parameters.
    * 
    * If some of the named parameters are not present in the original 
    * function, and $strict is false, they will be applied to the
    * function as extra arguments which can be accessed with func_get_args(),
    * or else a \BadFunctionCallException will be thrown.
    * 
    * Can be used like this:
    * 
    *    $args = array(&#x27;param1&#x27; =&gt; &#x27;value1&#x27;, &#x27;param2&#x27; =&gt; &#x27;value2&#x27;);
    *    call_user_func_assoc(&#x27;function&#x27;, $args);
    *    call_user_func_assoc(&#x27;class::static_method&#x27;, $args);
    *    call_user_func_assoc(array(&#x27;class&#x27;, &#x27;static_method&#x27;), $args);
    *    call_user_func_assoc(array($obj, &#x27;method&#x27;), $args);
    * 
    * @param string|array   Name of function to be called, or array containing
    *                       an object and the method name, or array containing
    *                       a class name and the static method name
    * @param array          Array containing parameters to be passed to the
    *                       function using their name (ie array key)
    * @param bool           Whether to throw or suppress an exception if there
    *                       are extraneous arguments in the given parameters
    *                       array.
    * 
    * @props &lt;http://www.php.net/manual/en/function.call-user-func-array.php#66121&gt;
    */
    public static function call_user_func_assoc($function_name, array $params, $strict=false) {
        
        if (is_string($function_name) &amp;&amp; preg_match(&#x27;/::/&#x27;, $function_name))
            $function_name = preg_split(&#x27;/::/&#x27;, $function_name, 2);
        
        if (is_array($function_name)) {
            try {
                if (is_object($function_name[0]))
                    $reflectObject = new \ReflectionObject($function_name[0]);
                else
                    $reflectObject = new \ReflectionClass($function_name[0]);
                $reflect = $reflectObject-&gt;getMethod($function_name[1]);
            } catch (\ReflectionException $e) {
                throw new \BadFunctionCallException(
                    &quot;Call to undefined function &#x27;&quot;.
                        self::get_func_repr($function_name).&quot;&#x27;&quot;);
            }
        } else {
            try {
                $reflect = new \ReflectionFunction($function_name);
            } catch (\ReflectionException $e) {
                throw new \BadFunctionCallException(
                    &quot;Call to undefined function &#x27;&quot;.
                        self::get_func_repr($function_name).&quot;&#x27;&quot;);
            }
        }
        
        $func_args = array();
        foreach ($reflect-&gt;getParameters() as $i =&gt; $param) {
            $pname = $param-&gt;getName();
            if (array_key_exists($pname, $params)) {
                $func_args[$pname] = $params[$pname];
            } else if ($param-&gt;isDefaultValueAvailable()) {
                $func_args[$pname] = $param-&gt;getDefaultValue();
            } else {
                // missing required parameter
                throw new \BadFunctionCallException(
                    sprintf(&#x27;Call to &quot;%s&quot;, missing parameter #%d &quot;%s&quot;&#x27;,
                        self::get_func_repr($function_name), $i+1, $pname));
            }
        }
        
        $extra_func_args = array_diff_key($params, $func_args);
        if ($strict &amp;&amp; !empty($extra_func_args))
            throw new \BadFunctionCallException(
                sprintf(&#x27;Call to &quot;%s&quot;, extraneous parameters given&#x27;,
                    self::get_func_repr($function_name)));
        
        return call_user_func_array($function_name, array_merge($func_args,
                                                                $extra_func_args));
    }
    
    public static function get_func_repr($callable) {
        $n = null;
        is_callable($callable, true, $n);
        return $n;
    }
    
    /**
    *   &gt;&gt;&gt; $contents = null;
    *   &gt;&gt;&gt; $file = new File(&#x27;path/to/file&#x27;);
    *   &gt;&gt;&gt; functional::with($file, function($handle) use (&amp;$contents) {
    *   ...     $contents = fread($handle, 8 * 1024);
    *   ... });
    *   &gt;&gt;&gt; print $contents;
    * 
    * Equivalent to:
    * 
    *   &gt;&gt;&gt; $contents = null;
    *   &gt;&gt;&gt; $handle = fopen(&#x27;path/to/file&#x27;, &#x27;r&#x27;);
    *   &gt;&gt;&gt; try {
    *   ...     $contents = fread($handle, 8 * 1024);
    *   ... } catch (\Exception $e) {
    *   ...     fclose($handle);
    *   ...     throw $e;
    *   ... }
    *   &gt;&gt;&gt; fclose($handle);
    *   &gt;&gt;&gt; print $contents;
    */
    public static function with(ContextManager $manager, \Closure $fn) {
        $obj = $manager-&gt;__enter();
        try {
            $fn($obj);
        } catch (\Exception $e) {
            $ret = $manager-&gt;__exit($e);
            if ($ret !== true)
                throw $e;
            return;
        }
        $manager-&gt;__exit(null);
    }
    
    /**
    * Helper to wrap an object and essentially re-bind it for use inside a
    * closure. Useful for working around PHP&#x27;s restriction of using &#x27;$this&#x27;
    * inside a closure.
    *
    * Use like so:
    *
    *   &gt;&gt;&gt; $proxy = functional::proxy($this, function($self, $arg1, $arg2) {
    *   ...     // in here: $self === $this
    *   ...     return &quot;{$arg1} {$arg2}&quot;;
    *   ... });
    *   &gt;&gt;&gt; print $proxy(&#x27;hello&#x27;, &#x27;world&#x27;);
    *   ... &#x27;hello world&#x27;
    */
    public static function proxy($obj, \Closure $fn) {
        return function() use ($obj, $fn) {
            $args = func_get_args();
            array_unshift($args, $obj);
            return call_user_func_array($fn, $args);
        };
    }
}

}

namespace bjork\utils\functional {

interface ContextManager {
    public function __enter();
    public function __exit(\Exception $e=null);
}

/**
* A wrapper for another class that can be used to delay instantiation of the
* wrapped class.
* 
* By subclassing, you have the opportunity to intercept and alter the
* instantiation. If you don&#x27;t need to do that, use SimpleLazyObject.
* 
* Caveats:
*
*   - Reflection on properties breaks.
*   - Static functions on wrapped objects cannot be called.
*   - All arguments provided are not passed by reference to the wrapped
*     object.
*/
abstract class LazyObject implements \Countable {
    
    const EMPTY_SENTINEL = -129834765;
    
    var $_wrapped;
    
    function __construct() {
        $this-&gt;_wrapped = self::EMPTY_SENTINEL;
    }
    
    function __get($name) {
        $this-&gt;load($name);
        return $this-&gt;_wrapped-&gt;$name;
    }
    
    function __set($name, $value) {
        $this-&gt;load($name);
        $this-&gt;_wrapped-&gt;$name = $value;
    }
    
    function __isset($name) {
        $this-&gt;load($name);
        return isset($this-&gt;_wrapped-&gt;$name);
    }
    
    function __unset($name) {
        $this-&gt;load($name);
        unset($this-&gt;_wrapped-&gt;$name);
    }
    
    function __call($name, $arguments) {
        $this-&gt;load($name);
        return call_user_func_array(array($this-&gt;_wrapped, $name), $arguments);
    }
    
    function count() {
        $this-&gt;load();
        return count($this-&gt;_wrapped);
    }
    
    function load($name=null) {
        if ($name === &#x27;_wrapped&#x27;)
            throw new \Exception(
                &#x27;&#x60;_wrapped&#x60; is used internally and cannot be accessed&#x27;);
        if ($this-&gt;_wrapped === self::EMPTY_SENTINEL)
            $this-&gt;setup();
    }
    
    abstract function setup();
}

/**
* A lazy object initialised from any function.
* 
* Designed for compound objects of unknown type. For builtins or objects of
* known type, use bjork.utils.functional.lazy.
*/
class SimpleLazyObject extends LazyObject {
    
    var $_setupfunc;
    
    /**
    * Pass in a callable that returns the object to be wrapped.
    *
    * If copies are made of the resulting SimpleLazyObject, which can happen
    * in various circumstances within Bjork, then you must ensure that the
    * callable can be safely run more than once and will return the same
    * value.
    */
    function __construct($func) {
        if (!is_callable($func))
            throw new \Exception(&#x27;Argument must be a callable&#x27;);
        $this-&gt;_setupfunc = $func;
        parent::__construct();
    }
    
    function __clone() {
        if ($this-&gt;_wrapped !== self::EMPTY_SENTINEL)
            $this-&gt;_wrapped = clone $this-&gt;_wrapped;
    }
    
    function __toString() {
        $this-&gt;load();
        return sprintf(&#x27;%s&#x27;, $this-&gt;_wrapped);
    }
    
    function setup() {
        $func = $this-&gt;_setupfunc;
        $this-&gt;_wrapped = $func();
    }
}

}

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>

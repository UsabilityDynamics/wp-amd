<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>core/modules/cdn-media/lib/aws-sdk-php/Aws/S3/S3Client.php - wp-flawless</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http://a3d72a45d111006ec192-ec5b80a12b0b09b4d52373336afb4254.r80.cf1.rackcdn.com/usability-dynamics.png" title="wp-flawless"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/API.html">API</a></li>
            
                <li><a href="../classes/Carrington.html">Carrington</a></li>
            
                <li><a href="../classes/Extended_Taxonomies.html">Extended_Taxonomies</a></li>
            
                <li><a href="../classes/Flawless.API.html">Flawless.API</a></li>
            
                <li><a href="../classes/Flawless.Asset.html">Flawless.Asset</a></li>
            
                <li><a href="../classes/Flawless.Branded_Login.html">Flawless.Branded_Login</a></li>
            
                <li><a href="../classes/Flawless.BuddyPress.html">Flawless.BuddyPress</a></li>
            
                <li><a href="../classes/Flawless.Content.html">Flawless.Content</a></li>
            
                <li><a href="../classes/Flawless.Element.html">Flawless.Element</a></li>
            
                <li><a href="../classes/Flawless.Flawless\Shortcode.html">Flawless.Flawless\Shortcode</a></li>
            
                <li><a href="../classes/Flawless.Management.html">Flawless.Management</a></li>
            
                <li><a href="../classes/Flawless.Mobile.html">Flawless.Mobile</a></li>
            
                <li><a href="../classes/Flawless.Navbars.html">Flawless.Navbars</a></li>
            
                <li><a href="../classes/Flawless.Schema.html">Flawless.Schema</a></li>
            
                <li><a href="../classes/Flawless.Settings.html">Flawless.Settings</a></li>
            
                <li><a href="../classes/Flawless.Styles.html">Flawless.Styles</a></li>
            
                <li><a href="../classes/Flawless.Utility.html">Flawless.Utility</a></li>
            
                <li><a href="../classes/Flawless.Widget.html">Flawless.Widget</a></li>
            
                <li><a href="../classes/flawless_wpp_extensions.html">flawless_wpp_extensions</a></li>
            
                <li><a href="../classes/Legacy.html">Legacy</a></li>
            
                <li><a href="../classes/License.html">License</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Log.html">Log</a></li>
            
                <li><a href="../classes/Maintenance.html">Maintenance</a></li>
            
                <li><a href="../classes/Models.html">Models</a></li>
            
                <li><a href="../classes/Module.html">Module</a></li>
            
                <li><a href="../classes/Multisite.html">Multisite</a></li>
            
                <li><a href="../classes/SaaS.html">SaaS</a></li>
            
                <li><a href="../classes/Shortcode.html">Shortcode</a></li>
            
                <li><a href="../classes/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../classes/Template Methods.html">Template Methods</a></li>
            
                <li><a href="../classes/Theme.html">Theme</a></li>
            
                <li><a href="../classes/UI.html">UI</a></li>
            
                <li><a href="../classes/Utility.html">Utility</a></li>
            
                <li><a href="../classes/Views.html">Views</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/API.html">API</a></li>
            
                <li><a href="../modules/Branded Login.html">Branded Login</a></li>
            
                <li><a href="../modules/Carrington.html">Carrington</a></li>
            
                <li><a href="../modules/Carrington Build.html">Carrington Build</a></li>
            
                <li><a href="../modules/carrington-build.html">carrington-build</a></li>
            
                <li><a href="../modules/cfct_build.html">cfct_build</a></li>
            
                <li><a href="../modules/default.html">default</a></li>
            
                <li><a href="../modules/Flawless.html">Flawless</a></li>
            
                <li><a href="../modules/Loader.html">Loader</a></li>
            
                <li><a href="../modules/Log.html">Log</a></li>
            
                <li><a href="../modules/Maintenence.html">Maintenence</a></li>
            
                <li><a href="../modules/Management.html">Management</a></li>
            
                <li><a href="../modules/Multisite.html">Multisite</a></li>
            
                <li><a href="../modules/SaaS.html">SaaS</a></li>
            
                <li><a href="../modules/Services_JSON.html">Services_JSON</a></li>
            
                <li><a href="../modules/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

Released under the GPL license
http:__www.opensource.org_licenses_gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

Released under the GPL license
http://www.opensource.org/licenses/gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/Theme UI.html">Theme UI</a></li>
            
                <li><a href="../modules/UI.html">UI</a></li>
            
                <li><a href="../modules/UsabilityDynamics.html">UsabilityDynamics</a></li>
            
                <li><a href="../modules/Utility.html">Utility</a></li>
            
                <li><a href="../modules/Views.html">Views</a></li>
            
                <li><a href="../modules/WP-Property.html">WP-Property</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: core/modules/cdn-media/lib/aws-sdk-php/Aws/S3/S3Client.php</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&lt;?php
/**
 * Copyright 2010-2013 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;).
 * You may not use this file except in compliance with the License.
 * A copy of the License is located at
 *
 * http://aws.amazon.com/apache2.0
 *
 * or in the &quot;license&quot; file accompanying this file. This file is distributed
 * on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */

namespace Aws\S3;

use Aws\Common\Client\AbstractClient;
use Aws\Common\Client\ClientBuilder;
use Aws\Common\Client\UploadBodyListener;
use Aws\Common\Enum\ClientOptions as Options;
use Aws\Common\Exception\InvalidArgumentException;
use Aws\S3\Exception\AccessDeniedException;
use Aws\S3\Exception\Parser\S3ExceptionParser;
use Aws\S3\Exception\S3Exception;
use Aws\S3\Model\ClearBucket;
use Aws\S3\S3Signature;
use Guzzle\Common\Collection;
use Guzzle\Http\Message\RequestInterface;
use Guzzle\Plugin\Backoff\BackoffPlugin;
use Guzzle\Plugin\Backoff\HttpBackoffStrategy;
use Guzzle\Plugin\Backoff\CurlBackoffStrategy;
use Guzzle\Plugin\Backoff\TruncatedBackoffStrategy;
use Guzzle\Plugin\Backoff\ExponentialBackoffStrategy;
use Guzzle\Plugin\Md5\CommandContentMd5Plugin;
use Guzzle\Service\Command\CommandInterface;
use Guzzle\Service\Command\Factory\AliasFactory;
use Guzzle\Service\Resource\Model;
use Guzzle\Service\Command\Factory\CompositeFactory;

/**
 * Client to interact with Amazon Simple Storage Service
 *
 * @method Model abortMultipartUpload(array $args = array()) {@command S3 AbortMultipartUpload}
 * @method Model completeMultipartUpload(array $args = array()) {@command S3 CompleteMultipartUpload}
 * @method Model copyObject(array $args = array()) {@command S3 CopyObject}
 * @method Model createBucket(array $args = array()) {@command S3 CreateBucket}
 * @method Model createMultipartUpload(array $args = array()) {@command S3 CreateMultipartUpload}
 * @method Model deleteBucket(array $args = array()) {@command S3 DeleteBucket}
 * @method Model deleteBucketCors(array $args = array()) {@command S3 DeleteBucketCors}
 * @method Model deleteBucketLifecycle(array $args = array()) {@command S3 DeleteBucketLifecycle}
 * @method Model deleteBucketPolicy(array $args = array()) {@command S3 DeleteBucketPolicy}
 * @method Model deleteBucketTagging(array $args = array()) {@command S3 DeleteBucketTagging}
 * @method Model deleteBucketWebsite(array $args = array()) {@command S3 DeleteBucketWebsite}
 * @method Model deleteObject(array $args = array()) {@command S3 DeleteObject}
 * @method Model deleteObjects(array $args = array()) {@command S3 DeleteObjects}
 * @method Model getBucketAcl(array $args = array()) {@command S3 GetBucketAcl}
 * @method Model getBucketCors(array $args = array()) {@command S3 GetBucketCors}
 * @method Model getBucketLifecycle(array $args = array()) {@command S3 GetBucketLifecycle}
 * @method Model getBucketLocation(array $args = array()) {@command S3 GetBucketLocation}
 * @method Model getBucketLogging(array $args = array()) {@command S3 GetBucketLogging}
 * @method Model getBucketNotification(array $args = array()) {@command S3 GetBucketNotification}
 * @method Model getBucketPolicy(array $args = array()) {@command S3 GetBucketPolicy}
 * @method Model getBucketRequestPayment(array $args = array()) {@command S3 GetBucketRequestPayment}
 * @method Model getBucketTagging(array $args = array()) {@command S3 GetBucketTagging}
 * @method Model getBucketVersioning(array $args = array()) {@command S3 GetBucketVersioning}
 * @method Model getBucketWebsite(array $args = array()) {@command S3 GetBucketWebsite}
 * @method Model getObject(array $args = array()) {@command S3 GetObject}
 * @method Model getObjectAcl(array $args = array()) {@command S3 GetObjectAcl}
 * @method Model getObjectTorrent(array $args = array()) {@command S3 GetObjectTorrent}
 * @method Model headBucket(array $args = array()) {@command S3 HeadBucket}
 * @method Model headObject(array $args = array()) {@command S3 HeadObject}
 * @method Model listBuckets(array $args = array()) {@command S3 ListBuckets}
 * @method Model listMultipartUploads(array $args = array()) {@command S3 ListMultipartUploads}
 * @method Model listObjectVersions(array $args = array()) {@command S3 ListObjectVersions}
 * @method Model listObjects(array $args = array()) {@command S3 ListObjects}
 * @method Model listParts(array $args = array()) {@command S3 ListParts}
 * @method Model putBucketAcl(array $args = array()) {@command S3 PutBucketAcl}
 * @method Model putBucketCors(array $args = array()) {@command S3 PutBucketCors}
 * @method Model putBucketLifecycle(array $args = array()) {@command S3 PutBucketLifecycle}
 * @method Model putBucketLogging(array $args = array()) {@command S3 PutBucketLogging}
 * @method Model putBucketNotification(array $args = array()) {@command S3 PutBucketNotification}
 * @method Model putBucketPolicy(array $args = array()) {@command S3 PutBucketPolicy}
 * @method Model putBucketRequestPayment(array $args = array()) {@command S3 PutBucketRequestPayment}
 * @method Model putBucketTagging(array $args = array()) {@command S3 PutBucketTagging}
 * @method Model putBucketVersioning(array $args = array()) {@command S3 PutBucketVersioning}
 * @method Model putBucketWebsite(array $args = array()) {@command S3 PutBucketWebsite}
 * @method Model putObject(array $args = array()) {@command S3 PutObject}
 * @method Model putObjectAcl(array $args = array()) {@command S3 PutObjectAcl}
 * @method Model restoreObject(array $args = array()) {@command S3 RestoreObject}
 * @method Model uploadPart(array $args = array()) {@command S3 UploadPart}
 * @method Model uploadPartCopy(array $args = array()) {@command S3 UploadPartCopy}
 * @method waitUntilBucketExists(array $input) Wait until a bucket exists. The input array uses the parameters of the HeadBucket operation and waiter specific settings
 * @method waitUntilBucketNotExists(array $input) Wait until a bucket does not exist. The input array uses the parameters of the HeadBucket operation and waiter specific settings
 * @method waitUntilObjectExists(array $input) Wait until an object exists. The input array uses the parameters of the HeadObject operation and waiter specific settings
 *
 * @link http://docs.aws.amazon.com/aws-sdk-php-2/guide/latest/service-s3.html User guide
 * @link http://docs.aws.amazon.com/aws-sdk-php-2/latest/class-Aws.S3.S3Client.html API docs
 */
class S3Client extends AbstractClient
{
    const LATEST_API_VERSION = &#x27;2006-03-01&#x27;;

    /**
     * @var array Aliases for S3 operations
     */
    protected static $commandAliases = array(
        // REST API Docs Aliases
        &#x27;GetService&#x27; =&gt; &#x27;ListBuckets&#x27;,
        &#x27;GetBucket&#x27;  =&gt; &#x27;ListObjects&#x27;,
        &#x27;PutBucket&#x27;  =&gt; &#x27;CreateBucket&#x27;,

        // SDK 1.x Aliases
        &#x27;GetBucketHeaders&#x27;              =&gt; &#x27;HeadBucket&#x27;,
        &#x27;GetObjectHeaders&#x27;              =&gt; &#x27;HeadObject&#x27;,
        &#x27;SetBucketAcl&#x27;                  =&gt; &#x27;PutBucketAcl&#x27;,
        &#x27;CreateObject&#x27;                  =&gt; &#x27;PutObject&#x27;,
        &#x27;DeleteObjects&#x27;                 =&gt; &#x27;DeleteMultipleObjects&#x27;,
        &#x27;PutObjectCopy&#x27;                 =&gt; &#x27;CopyObject&#x27;,
        &#x27;SetObjectAcl&#x27;                  =&gt; &#x27;PutObjectAcl&#x27;,
        &#x27;GetLogs&#x27;                       =&gt; &#x27;GetBucketLogging&#x27;,
        &#x27;GetVersioningStatus&#x27;           =&gt; &#x27;GetBucketVersioning&#x27;,
        &#x27;SetBucketPolicy&#x27;               =&gt; &#x27;PutBucketPolicy&#x27;,
        &#x27;CreateBucketNotification&#x27;      =&gt; &#x27;PutBucketNotification&#x27;,
        &#x27;GetBucketNotifications&#x27;        =&gt; &#x27;GetBucketNotification&#x27;,
        &#x27;CopyPart&#x27;                      =&gt; &#x27;UploadPartCopy&#x27;,
        &#x27;CreateWebsiteConfig&#x27;           =&gt; &#x27;PutBucketWebsite&#x27;,
        &#x27;GetWebsiteConfig&#x27;              =&gt; &#x27;GetBucketWebsite&#x27;,
        &#x27;DeleteWebsiteConfig&#x27;           =&gt; &#x27;DeleteBucketWebsite&#x27;,
        &#x27;CreateObjectExpirationConfig&#x27;  =&gt; &#x27;PutBucketLifecycle&#x27;,
        &#x27;GetObjectExpirationConfig&#x27;     =&gt; &#x27;GetBucketLifecycle&#x27;,
        &#x27;DeleteObjectExpirationConfig&#x27;  =&gt; &#x27;DeleteBucketLifecycle&#x27;,
    );

    /**
     * @inheritdoc
     */
    protected $directory = __DIR__;

    /**
     * Factory method to create a new Amazon S3 client using an array of configuration options.
     *
     * The following array keys and values are available options:
     *
     * Credential options (key, secret, and optional token OR credentials is required)
     *
     * - key - AWS Access Key ID
     * - secret - AWS secret access key
     * - credentials - You can optionally provide a custom &#x60;Aws\Common\Credentials\CredentialsInterface&#x60; object
     * - token - Custom AWS security token to use with request authentication
     * - token.ttd - UNIX timestamp for when the custom credentials expire
     * - credentials.cache - Used to cache credentials when using providers that require HTTP requests. Set the true
     *   to use the default APC cache or provide a &#x60;Guzzle\Cache\CacheAdapterInterface&#x60; object.
     * - credentials.cache.key - Optional custom cache key to use with the credentials
     * - credentials.client - Pass this option to specify a custom &#x60;Guzzle\Http\ClientInterface&#x60; to use if your
     *   credentials require a HTTP request (e.g. RefreshableInstanceProfileCredentials)
     *
     * Region and Endpoint options (a &#x60;region&#x60; and optional &#x60;scheme&#x60; OR a &#x60;base_url&#x60; is required)
     *
     * - region - Region name (e.g. &#x27;us-east-1&#x27;, &#x27;us-west-1&#x27;, &#x27;us-west-2&#x27;, &#x27;eu-west-1&#x27;, etc...)
     * - scheme - URI Scheme of the base URL (e.g. &#x27;https&#x27;, &#x27;http&#x27;).
     * - base_url - Instead of using a &#x60;region&#x60; and &#x60;scheme&#x60;, you can specify a custom base URL for the client
     *
     * Generic client options
     *
     * - ssl.certificate_authority: Set to true to use the bundled CA cert (default), system to use the certificate
     *   bundled with your system, or pass the full path to an SSL certificate bundle. This option should be used when
     *   you encounter curl error code 60.
     * - curl.options - Array of cURL options to apply to every request.
     *   See http://www.php.net/manual/en/function.curl-setopt.php for a list of available options
     * - signature - You can optionally provide a custom signature implementation used to sign requests
     * - client.backoff.logger - &#x60;Guzzle\Log\LogAdapterInterface&#x60; object used to log backoff retries. Use
     *   &#x27;debug&#x27; to emit PHP warnings when a retry is issued.
     * - client.backoff.logger.template - Optional template to use for exponential backoff log messages. See
     *   &#x60;Guzzle\Plugin\Backoff\BackoffLogger&#x60; for formatting information.
     *
     * @param array|Collection $config Client configuration data
     *
     * @return self
     */
    public static function factory($config = array())
    {
        // Configure the custom exponential backoff plugin for retrying S3 specific errors
        if (!isset($config[Options::BACKOFF])) {
            $config[Options::BACKOFF] = new BackoffPlugin(
                new TruncatedBackoffStrategy(3,
                    new HttpBackoffStrategy(null,
                        new SocketTimeoutChecker(
                            new CurlBackoffStrategy(null,
                                new ExponentialBackoffStrategy()
                            )
                        )
                    )
                )
            );
        }

        $client = ClientBuilder::factory(__NAMESPACE__)
            -&gt;setConfig($config)
            -&gt;setConfigDefaults(array(
                Options::SIGNATURE =&gt; new S3Signature(),
                Options::VERSION =&gt; self::LATEST_API_VERSION,
                Options::SERVICE_DESCRIPTION =&gt; __DIR__ . &#x27;/Resources/s3-%s.php&#x27;
            ))
            -&gt;setExceptionParser(new S3ExceptionParser())
            -&gt;setIteratorsConfig(array(
                &#x27;more_key&#x27; =&gt; &#x27;IsTruncated&#x27;,
                &#x27;operations&#x27; =&gt; array(
                    &#x27;ListBuckets&#x27;,
                    &#x27;ListMultipartUploads&#x27; =&gt; array(
                        &#x27;limit_param&#x27; =&gt; &#x27;MaxUploads&#x27;,
                        &#x27;token_param&#x27; =&gt; array(&#x27;KeyMarker&#x27;, &#x27;UploadIdMarker&#x27;),
                        &#x27;token_key&#x27;   =&gt; array(&#x27;NextKeyMarker&#x27;, &#x27;NextUploadIdMarker&#x27;),
                    ),
                    &#x27;ListObjects&#x27; =&gt; array(
                        &#x27;limit_param&#x27; =&gt; &#x27;MaxKeys&#x27;,
                        &#x27;token_param&#x27; =&gt; &#x27;Marker&#x27;,
                        &#x27;token_key&#x27;   =&gt; &#x27;NextMarker&#x27;,
                    ),
                    &#x27;ListObjectVersions&#x27; =&gt; array(
                        &#x27;limit_param&#x27; =&gt; &#x27;MaxKeys&#x27;,
                        &#x27;token_param&#x27; =&gt; array(&#x27;KeyMarker&#x27;, &#x27;VersionIdMarker&#x27;),
                        &#x27;token_key&#x27;   =&gt; array(&#x27;nextKeyMarker&#x27;, &#x27;nextVersionIdMarker&#x27;),
                    ),
                    &#x27;ListParts&#x27; =&gt; array(
                        &#x27;limit_param&#x27; =&gt; &#x27;MaxParts&#x27;,
                        &#x27;result_key&#x27;  =&gt; &#x27;Parts&#x27;,
                        &#x27;token_param&#x27; =&gt; &#x27;PartNumberMarker&#x27;,
                        &#x27;token_key&#x27;   =&gt; &#x27;NextPartNumberMarker&#x27;,
                    ),
                )
            ))
            -&gt;build();

        // Use virtual hosted buckets when possible
        $client-&gt;addSubscriber(new BucketStyleListener());

        // Ensure that ACP headers are applied when needed
        $client-&gt;addSubscriber(new AcpListener());

        // Validate and add Content-MD5 hashes
        $client-&gt;addSubscriber(new CommandContentMd5Plugin());

        // Allow for specifying bodies with file paths and file handles
        $client-&gt;addSubscriber(new UploadBodyListener(array(&#x27;PutObject&#x27;, &#x27;UploadPart&#x27;)));

        // Add aliases for some S3 operations
        $default = CompositeFactory::getDefaultChain($client);
        $default-&gt;add(
            new AliasFactory($client, self::$commandAliases),
            &#x27;Guzzle\Service\Command\Factory\ServiceDescriptionFactory&#x27;
        );
        $client-&gt;setCommandFactory($default);

        return $client;
    }

    /**
     * Find out if a string is a valid name for an Amazon S3 bucket.
     *
     * @param string $bucket The name of the bucket to check.
     *
     * @return bool TRUE if the bucket name is valid or FALSE if it is invalid.
     */
    public static function isValidBucketName($bucket)
    {
        $bucketLen = strlen($bucket);
        if (!$bucket || $bucketLen &lt; 3 || $bucketLen &gt; 63
            // Cannot start or end with a &#x27;.&#x27;
            || $bucket[0] == &#x27;.&#x27;
            || $bucket[$bucketLen - 1] == &#x27;.&#x27;
            // Cannot look like an IP address
            || preg_match(&#x27;/^\d+\.\d+\.\d+\.\d+$/&#x27;, $bucket)
            // Cannot include special characters, must start and end with lower alnum
            || !preg_match(&#x27;/^[a-z0-9][a-z0-9\-.]*[a-z0-9]?$/&#x27;, $bucket)) {
            return false;
        }

        return true;
    }

    /**
     * Create a pre-signed URL for a request
     *
     * @param RequestInterface $request Request to generate the URL for. Use the factory methods of the client to create
     *                                  this request object.
     * @param int|string $expires The Unix timestamp to expire at or a string that can be evaluated by strtotime
     *
     * @return string
     * @throws InvalidArgumentException if the request is not associated with this client object
     */
    public function createPresignedUrl(RequestInterface $request, $expires)
    {
        if ($request-&gt;getClient() !== $this) {
            throw new InvalidArgumentException(&#x27;The request object must be associated with the client. Use the &#x27;
                . &#x27;$client-&gt;get(), $client-&gt;head(), $client-&gt;post(), $client-&gt;put(), etc. methods when passing in a &#x27;
                . &#x27;request object&#x27;);
        }

        if (!is_numeric($expires)) {
            $expires = strtotime($expires);
        }

        $copy = clone $request;

        // URL encoding already occurs in the URI template expansion. Undo that and encode using the same encoding as
        // GET object, PUT object, etc.
        $path = $this-&gt;encodeKey(rawurldecode($copy-&gt;getPath()));
        $copy-&gt;setPath($path);

        $copy-&gt;getQuery()
            -&gt;set(&#x27;AWSAccessKeyId&#x27;, $this-&gt;credentials-&gt;getAccessKeyId())
            -&gt;set(&#x27;Expires&#x27;, $expires)
            -&gt;set(&#x27;Signature&#x27;, $this-&gt;signature-&gt;signString(
                $this-&gt;signature-&gt;createCanonicalizedString($request, $expires),
                $this-&gt;credentials
            ));

        return $copy-&gt;getUrl();
    }

    /**
     * Helper used to clear the contents of a bucket. Use the {@see ClearBucket} object directly
     * for more advanced options and control.
     *
     * @param string $bucket Name of the bucket to clear.
     *
     * @return int Returns the number of deleted keys
     */
    public function clearBucket($bucket)
    {
        $clear = new ClearBucket($this, $bucket);

        return $clear-&gt;clear();
    }

    /**
     * Determines whether or not a bucket exists by name
     *
     * @param string $bucket    The name of the bucket
     * @param bool   $accept403 Set to true if 403s are acceptable
     * @param array  $options   Additional options to add to the executed command
     *
     * @return bool
     */
    public function doesBucketExist($bucket, $accept403 = true, array $options = array())
    {
        return $this-&gt;checkExistenceWithCommand(
            $this-&gt;getCommand(&#x27;HeadBucket&#x27;, array_merge($options, array(
                &#x27;Bucket&#x27; =&gt; $bucket
            ))), $accept403
        );
    }

    /**
     * Determines whether or not an object exists by name
     *
     * @param string $bucket  The name of the bucket
     * @param string $key     The key of the object
     * @param array  $options Additional options to add to the executed command
     *
     * @return bool
     */
    public function doesObjectExist($bucket, $key, array $options = array())
    {
        return $this-&gt;checkExistenceWithCommand(
            $this-&gt;getCommand(&#x27;HeadObject&#x27;, array_merge($options, array(
                &#x27;Bucket&#x27; =&gt; $bucket,
                &#x27;Key&#x27;    =&gt; $key
            )))
        );
    }

    /**
     * Determines whether or not a bucket policy exists for a bucket
     *
     * @param string $bucket  The name of the bucket
     * @param array  $options Additional options to add to the executed command
     *
     * @return bool
     */
    public function doesBucketPolicyExist($bucket, array $options = array())
    {
        return $this-&gt;checkExistenceWithCommand(
            $this-&gt;getCommand(&#x27;GetBucketPolicy&#x27;, array_merge($options, array(
                &#x27;Bucket&#x27; =&gt; $bucket
            )))
        );
    }

    /**
     * Raw URL encode a key and allow for &#x27;/&#x27; characters
     *
     * @param string $key Key to encode
     *
     * @return string Returns the encoded key
     */
    public static function encodeKey($key)
    {
        return str_replace(&#x27;%2F&#x27;, &#x27;/&#x27;, rawurlencode($key));
    }

    /**
     * Explode a prefixed key into an array of values
     *
     * @param string $key Key to explode
     *
     * @return array Returns the exploded
     */
    public static function explodeKey($key)
    {
        // Remove a leading slash if one is found
        return explode(&#x27;/&#x27;, $key &amp;&amp; $key[0] == &#x27;/&#x27; ? substr($key, 1) : $key);
    }

    /**
     * Register the Amazon S3 stream wrapper and associates it with this client object
     *
     * @return self
     */
    public function registerStreamWrapper()
    {
        StreamWrapper::register($this);

        return $this;
    }

    /**
     * Determines whether or not a resource exists using a command
     *
     * @param CommandInterface $command   Command used to poll for the resource
     * @param bool             $accept403 Set to true if 403s are acceptable
     *
     * @return bool
     * @throws S3Exception if there is an unhandled exception
     */
    protected function checkExistenceWithCommand(CommandInterface $command, $accept403 = false)
    {
        try {
            $command-&gt;execute();
            $exists = true;
        } catch (AccessDeniedException $e) {
            $exists = (bool) $accept403;
        } catch (S3Exception $e) {
            $exists = false;
            if ($e-&gt;getResponse()-&gt;getStatusCode() &gt;= 500) {
                // @codeCoverageIgnoreStart
                throw $e;
                // @codeCoverageIgnoreEnd
            }
        }

        return $exists;
    }
}

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>

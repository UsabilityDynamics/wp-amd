<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>core/modules/cdn-media/lib/Bjork/lib/gettext.php - wp-flawless</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http://a3d72a45d111006ec192-ec5b80a12b0b09b4d52373336afb4254.r80.cf1.rackcdn.com/usability-dynamics.png" title="wp-flawless"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/API.html">API</a></li>
            
                <li><a href="../classes/Carrington.html">Carrington</a></li>
            
                <li><a href="../classes/Extended_Taxonomies.html">Extended_Taxonomies</a></li>
            
                <li><a href="../classes/Flawless.API.html">Flawless.API</a></li>
            
                <li><a href="../classes/Flawless.Asset.html">Flawless.Asset</a></li>
            
                <li><a href="../classes/Flawless.Branded_Login.html">Flawless.Branded_Login</a></li>
            
                <li><a href="../classes/Flawless.BuddyPress.html">Flawless.BuddyPress</a></li>
            
                <li><a href="../classes/Flawless.Content.html">Flawless.Content</a></li>
            
                <li><a href="../classes/Flawless.Element.html">Flawless.Element</a></li>
            
                <li><a href="../classes/Flawless.Flawless\Shortcode.html">Flawless.Flawless\Shortcode</a></li>
            
                <li><a href="../classes/Flawless.Management.html">Flawless.Management</a></li>
            
                <li><a href="../classes/Flawless.Mobile.html">Flawless.Mobile</a></li>
            
                <li><a href="../classes/Flawless.Navbars.html">Flawless.Navbars</a></li>
            
                <li><a href="../classes/Flawless.Schema.html">Flawless.Schema</a></li>
            
                <li><a href="../classes/Flawless.Settings.html">Flawless.Settings</a></li>
            
                <li><a href="../classes/Flawless.Styles.html">Flawless.Styles</a></li>
            
                <li><a href="../classes/Flawless.Utility.html">Flawless.Utility</a></li>
            
                <li><a href="../classes/Flawless.Widget.html">Flawless.Widget</a></li>
            
                <li><a href="../classes/flawless_wpp_extensions.html">flawless_wpp_extensions</a></li>
            
                <li><a href="../classes/Legacy.html">Legacy</a></li>
            
                <li><a href="../classes/License.html">License</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Log.html">Log</a></li>
            
                <li><a href="../classes/Maintenance.html">Maintenance</a></li>
            
                <li><a href="../classes/Models.html">Models</a></li>
            
                <li><a href="../classes/Module.html">Module</a></li>
            
                <li><a href="../classes/Multisite.html">Multisite</a></li>
            
                <li><a href="../classes/SaaS.html">SaaS</a></li>
            
                <li><a href="../classes/Shortcode.html">Shortcode</a></li>
            
                <li><a href="../classes/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../classes/Template Methods.html">Template Methods</a></li>
            
                <li><a href="../classes/Theme.html">Theme</a></li>
            
                <li><a href="../classes/UI.html">UI</a></li>
            
                <li><a href="../classes/Utility.html">Utility</a></li>
            
                <li><a href="../classes/Views.html">Views</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/API.html">API</a></li>
            
                <li><a href="../modules/Branded Login.html">Branded Login</a></li>
            
                <li><a href="../modules/Carrington.html">Carrington</a></li>
            
                <li><a href="../modules/Carrington Build.html">Carrington Build</a></li>
            
                <li><a href="../modules/carrington-build.html">carrington-build</a></li>
            
                <li><a href="../modules/cfct_build.html">cfct_build</a></li>
            
                <li><a href="../modules/default.html">default</a></li>
            
                <li><a href="../modules/Flawless.html">Flawless</a></li>
            
                <li><a href="../modules/Loader.html">Loader</a></li>
            
                <li><a href="../modules/Log.html">Log</a></li>
            
                <li><a href="../modules/Maintenence.html">Maintenence</a></li>
            
                <li><a href="../modules/Management.html">Management</a></li>
            
                <li><a href="../modules/Multisite.html">Multisite</a></li>
            
                <li><a href="../modules/SaaS.html">SaaS</a></li>
            
                <li><a href="../modules/Services_JSON.html">Services_JSON</a></li>
            
                <li><a href="../modules/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

Released under the GPL license
http:__www.opensource.org_licenses_gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

Released under the GPL license
http://www.opensource.org/licenses/gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/Theme UI.html">Theme UI</a></li>
            
                <li><a href="../modules/UI.html">UI</a></li>
            
                <li><a href="../modules/UsabilityDynamics.html">UsabilityDynamics</a></li>
            
                <li><a href="../modules/Utility.html">Utility</a></li>
            
                <li><a href="../modules/Views.html">Views</a></li>
            
                <li><a href="../modules/WP-Property.html">WP-Property</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: core/modules/cdn-media/lib/Bjork/lib/gettext.php</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&lt;?php

namespace gettext {

/*
    TODO:
    
        - Remove php-gettext dependancy
        - Provide lazy .mo-file loading (php-gettext does that already -- see
          if we can extract it)
*/

require_once &#x27;php-gettext/streams.php&#x27;;
require_once &#x27;php-gettext/gettext.php&#x27;;

class IOError extends \Exception {}

/**
* Translation classes are what actually implement the translation of original
* source file message strings to translated message strings. The base class
* used by all translation classes is NullTranslations; this provides the basic
* interface you can use to write your own specialized translation classes.
*/
class NullTranslations {
    protected
        $info,
        $charset,
        $outputCharset,
        $fallback;
    
    function __construct($filename=null) {
        $this-&gt;info = array();
        $this-&gt;charset = null;
        $this-&gt;outputCharset = null;
        $this-&gt;fallback = null;
        
        if (!is_null($filename))
            $this-&gt;parse($filename);
    }
    
    protected function parse($filename) {}
    
    protected function encode($string, $charset=null) {
        if (is_null($charset))
            $charset = mb_internal_encoding();
        $sourceCharset = mb_detect_encoding($string);
        if (strtolower($sourceCharset) != strtolower($charset))
            return mb_convert_encoding($string, $charset, $sourceCharset);
        return $string;
    }
    
    public function addFallback($fallback) {
        if (!is_null($this-&gt;fallback))
            $this-&gt;fallback-&gt;addFallback($fallback);
        else
            $this-&gt;fallback = $fallback;
    }
    
    public function gettext($msg) {
        if (!is_null($this-&gt;fallback))
            return $this-&gt;fallback-&gt;gettext($msg);
        return $msg;
    }
    
    public function ngettext($msg1, $msg2, $n) {
        if (!is_null($this-&gt;fallback))
            return $this-&gt;fallback-&gt;ngettext($msg1, $msg2, $n);
        if ($n == 1)
            return $msg1;
        return $msg2;
    }
    
    public function lgettext($msg) {
        if (!is_null($this-&gt;fallback))
            return $this-&gt;fallback-&gt;lgettext($msg);
        return $msg;
    }
    
    public function lngettext($msg1, $msg2, $n) {
        if (!is_null($this-&gt;fallback))
            return $this-&gt;fallback-&gt;lngettext($msg1, $msg2, $n);
        if ($n == 1)
            return $msg1;
        return $msg2;
    }
    
    public function ugettext($msg) {
        if (!is_null($this-&gt;fallback))
            return $this-&gt;fallback-&gt;ugettext($msg);
        // return $this-&gt;encode($msg, &quot;utf-8&quot;);
        return $msg;
    }
    
    public function ungettext($msg1, $msg2, $n) {
        if (!is_null($this-&gt;fallback))
            return $this-&gt;fallback-&gt;ungettext($msg1, $msg2, $n);
        if ($n == 1)
            // return $this-&gt;encode($msg1, &quot;utf-8&quot;);
            return $msg1;
        // return $this-&gt;encode($msg2, &quot;utf-8&quot;);
        return $msg2;
    }
    
    public function getInfo() {
        return $this-&gt;info;
    }
    
    public function getCharset() {
        return $this-&gt;charset;
    }
    
    public function getOutputCharset() {
        return $this-&gt;outputCharset;
    }
    
    public function setOutputCharset($charset) {
        $this-&gt;outputCharset = $charset;
    }
    
    public function install($names=null) {
        throw new \Exception(&quot;Not implemented&quot;);
    }
}

/**
* The gettext module provides one additional class derived from
* NullTranslations: GNUTranslations. This class overrides parse() to enable
* reading GNU gettext format .mo files in both big-endian and little-endian
* format. It also coerces both message ids and message strings to Unicode.
* 
* GNUTranslations parses optional meta-data out of the translation catalog.
* It is convention with GNU gettext to include meta-data as the translation
* for the empty string. This meta-data is in RFC 822-style key: value pairs,
* and should contain the Project-Id-Version key. If the key Content-Type is
* found, then the charset property is used to initialize the “protected”
* charset instance variable, defaulting to None if not found. If the charset
* encoding is specified, then all message ids and message strings read from
* the catalog are converted to Unicode using this encoding. The ugettext()
* method always returns a Unicode, while the gettext() returns an encoded
* 8-bit string. For the message id arguments of both methods, either Unicode
* strings or 8-bit strings containing only US-ASCII characters are acceptable.
* Note that the Unicode version of the methods (i.e. ugettext() and
* ungettext()) are the recommended interface to use for internationalized
* Python programs.
* 
* The entire set of key/value pairs are placed into a dictionary and set as
* the “protected” info instance variable.
* 
* If the .mo file’s magic number is invalid, or if other problems occur while
* reading the file, instantiating a GNUTranslations class can raise IOError.
*/
class GNUTranslations extends NullTranslations {
    /*protected*/ var $catalogue; // declared public to be able to test
    
    protected function parse($mofilename) {
        $stream = new \FileReader($mofilename);
        $reader = new \gettext_reader($stream, true); // always cache -- we use undocumented api
        
        // we&#x27;re making use of private api -- load_tables and cache_translations
        $reader-&gt;load_tables();
        $info = $reader-&gt;cache_translations[&#x27;&#x27;]; // DANGER: this might be break
        $info = explode(&quot;\n&quot;, $info);
        $lastk = $k = null;
        foreach ($info as $line) {
            if (empty($line))
                continue;
            if (false !== strpos($line, &quot;:&quot;)) {
                list($k, $v) = preg_split(&quot;/:/u&quot;, $line, 2, PREG_SPLIT_NO_EMPTY);
                $k = strtolower($k);
                $k = trim($k);
                $v = trim($v);
                $this-&gt;info[$k] = $v;
                $lastk = $k;
            } else if (!empty($lastk)) {
                $this-&gt;info[$lastk] .= &quot;\n&quot; . $line;
            }
            if ($k == &quot;content-type&quot;) {
                $c = explode(&quot;charset=&quot;, $v);
                $this-&gt;charset = $c[1];
            }
        }
        
        if (empty($this-&gt;charset))
            $this-&gt;charset = &quot;ascii&quot;;
        
        $this-&gt;catalogue = $reader;
    }
    
    protected function lookup($msg, $default=null) {
        // we make use of private api -- cache_translations
        if (isset($this-&gt;catalogue-&gt;cache_translations[$msg]))
            return $this-&gt;catalogue-&gt;cache_translations[$msg];
        return $default;
    }
    
    public function gettext($msg) {
        $tmsg = $this-&gt;lookup($msg, null);
        if (is_null($tmsg)) {
            if (!is_null($this-&gt;fallback))
                return $this-&gt;fallback-&gt;gettext($msg);
            return $msg;
        }
        // Encode the Unicode tmsg back to an 8-bit string, if possible
        if (!is_null($this-&gt;outputCharset))
            return $this-&gt;encode($tmsg, $this-&gt;outputCharset);
        else if (!is_null($this-&gt;charset))
            return $this-&gt;encode($tmsg, $this-&gt;charset);
        return $tmsg;
    }
    
    public function ngettext($msg1, $msg2, $n) {
        $key = $msg1 . chr(0) . $msg2; 
        $tmsg = $this-&gt;lookup($key, null);
        if (is_null($tmsg)) {
            if (!is_null($this-&gt;fallback))
                return $this-&gt;fallback-&gt;ngettext($msg1, $msg2, $n);
            if ($n == 1)
                return $msg1;
            return $msg2;
        }
        $tmsg = $this-&gt;catalogue-&gt;ngettext($msg1, $msg2, $n);
        if (!is_null($this-&gt;outputCharset))
            return $this-&gt;encode($tmsg, $this-&gt;outputCharset);
        else if (!is_null($this-&gt;charset))
            return $this-&gt;encode($tmsg, $this-&gt;charset);
        return $tmsg;
    }
    
    public function lgettext($msg) {
        $tmsg = $this-&gt;lookup($msg, null);
        if (is_null($tmsg)) {
            if (!is_null($this-&gt;fallback))
                return $this-&gt;fallback-&gt;lgettext($msg);
            return $msg;
        }
        // uses internal encoding if outputCharset is null
        return $this-&gt;encode($tmsg, $this-&gt;outputCharset);
    }
    
    public function lngettext($msg1, $msg2, $n) {
        $key = $msg1 . chr(0) . $msg2; 
        $tmsg = $this-&gt;lookup($key, null);
        if (is_null($tmsg)) {
            if (!is_null($this-&gt;fallback))
                return $this-&gt;fallback-&gt;lngettext($msg1, $msg2, $n);
            if ($n == 1)
                return $msg1;
            return $msg2;
        }
        return $this-&gt;encode($this-&gt;catalogue-&gt;ngettext($msg1, $msg2, $n), $this-&gt;outputCharset);
    }
    
    public function ugettext($msg) {
        $tmsg = $this-&gt;lookup($msg, null);
        if (is_null($tmsg)) {
            if (!is_null($this-&gt;fallback))
                return $this-&gt;fallback-&gt;ugettext($msg);
            //return $this-&gt;encode($msg, &quot;utf-8&quot;);
            return $msg;
        }
        return $tmsg;
    }
    
    public function ungettext($msg1, $msg2, $n) {
        $key = $msg1 . chr(0) . $msg2; 
        $tmsg = $this-&gt;lookup($key, null);
        if (is_null($tmsg)) {
            if (!is_null($this-&gt;fallback))
                return $this-&gt;fallback-&gt;ungettext($msg1, $msg2, $n);
            if ($n == 1)
                // return $this-&gt;encode($msg1, &quot;utf-8&quot;);
                return $msg1;
            // return $this-&gt;encode($msg2, &quot;utf-8&quot;);
            return $msg2;
        }
        return $this-&gt;catalogue-&gt;ngettext($msg1, $msg2, $n);
    }
}

}

namespace {

final class gettext {
    
    private static
        $default_localedir = &#x27;/usr/local/share/locale&#x27;,
        $translations = array(),
        $localedirs = array(),
        $localecodesets = array(),
        $current_domain = &quot;messages&quot;;
    
    /**
    * This function implements the standard .mo file search algorithm. It
    * takes a domain, identical to what textdomain() takes. Optional localedir
    * is as in bindtextdomain(). Optional languages is a list of strings,
    * where each string is a language code.
    * 
    * If localedir is not given, then the default system locale directory is
    * used. If languages is not given, then the following environment
    * variables are searched: LANGUAGE, LC_ALL, LC_MESSAGES, and LANG. The
    * first one returning a non-empty value is used for the languages
    * variable. The environment variables should contain a colon separated
    * list of languages, which will be split on the colon to produce the
    * expected list of language code strings.
    * 
    * find() then expands and normalizes the languages, and then iterates
    * through them, searching for an existing file built of these components:
    * 
    *   localedir/language/LC_MESSAGES/domain.mo
    * 
    * The first such file name that exists is returned by find(). If no such
    * file is found, then None is returned. If all is given, it returns a list
    * of all file names, in the order in which they appear in the languages
    * list or the environment variables.
    */
    public static function find($domain, $localedir=null, $languages=null, $all=false) {
        // Get some reasonable defaults for arguments that were not supplied
        if (is_null($localedir))
            $localedir = self::$default_localedir;
        if (is_null($languages)) {
            $languages = array();
            foreach (array(&#x27;LANGUAGE&#x27;, &#x27;LC_ALL&#x27;, &#x27;LC_MESSAGES&#x27;, &#x27;LANG&#x27;) as $envar) {
                if (isset($_ENV[$envar])) {
                    $val = $_ENV[$envar];
                    if (!empty($val)) {
                        $languages = explode(&quot;:&quot;, $val);
                        break;
                    }
                }
            }
            if (!in_array(&quot;C&quot;, $languages))
                $languages[] = &quot;C&quot;;
        }
        
        // now normalize and expand the languages
        $nelangs = array();
        foreach ($languages as $lang)
            foreach (self::expand_lang($lang) as $nelang)
                if (!in_array($nelang, $nelangs))
                    $nelangs[] = $nelang;
        
        // select a language
        if ($all) {
            $result = array();
        } else {
            $result = null;
        }
        foreach ($nelangs as $lang) {
            if ($lang == &quot;C&quot;)
                break;
            $mofile = implode(DIRECTORY_SEPARATOR, array(
                $localedir,
                $lang,
                &quot;LC_MESSAGES&quot;,
                &quot;$domain.mo&quot;,
            ));
            if (is_file($mofile))
                if ($all)
                    $result[] = $mofile;
                else
                    return $mofile;
        }
        return $result;
    }
    
    /**
    * Return a Translations instance based on the domain, localedir, and
    * languages, which are first passed to find() to get a list of the
    * associated .mo file paths. Instances with identical .mo file names
    * are cached. The actual class instantiated is either class_ if provided,
    * otherwise GNUTranslations. The class’s constructor must take a single
    * file object argument. If provided, codeset will change the charset used
    * to encode translated strings.
    * 
    * If multiple files are found, later files are used as fallbacks for
    * earlier ones. To allow setting the fallback, copy.copy() is used to
    * clone each translation object from the cache; the actual instance data
    * is still shared with the cache.
    * 
    * If no .mo file is found, this function raises IOError if fallback is
    * false (which is the default), and returns a NullTranslations instance
    * if fallback is true.
    */
    public static function translation($domain, $localedir=null, $languages=null, $class=null, $fallback=false, $codeset=null) {
        if (is_null($class))
            $class = &#x27;\gettext\GNUTranslations&#x27;;
        $mofiles = self::find($domain, $localedir, $languages, true); // find all
        if (empty($mofiles)) {
            if ($fallback)
                return new NullTranslations();
            throw new \gettext\IOError(
                &quot;No translation file found for domain &#x27;$domain&#x27;&quot;);
        }
        
        $result = null;
        foreach ($mofiles as $mofile) {
            $key = $class . chr(0) . realpath($mofile);
            $t = null;
            if (isset(self::$translations[$key]))
                $t = self::$translations[$key];
            if (is_null($t)) {
                $t = new $class($mofile);
                self::$translations[$key] = $t;
            }
            $t = clone $t; // shallow copy
            if (!is_null($codeset))
                $t-&gt;setOutputCharset($codeset);
            if (is_null($result))
                $result = $t;
            else
                $result-&gt;addFallback($t);
        }
        return $result;
    }
    
    /**
    * This installs the function _() in Python’s builtins namespace, based
    * on domain, localedir, and codeset which are passed to the function
    * translation(). The unicode flag is passed to the resulting translation
    * object’s install() method.
    * 
    * For the names parameter, please see the description of the translation
    * object’s install() method.
    * 
    * As seen below, you usually mark the strings in your application that
    * are candidates for translation, by wrapping them in a call to the
    * _() function, like this:
    * 
    *   print _(&#x27;This string will be translated.&#x27;)
    * 
    * For convenience, you want the _() function to be installed in Python’s
    * builtins namespace, so it is easily accessible in all modules of your
    * application.
    */
    public static function install($domain, $localedir=null, $codeset=null, $names=null) {
        $t = self::translation($domain, $localedir, null, null, false, $codeset);
        $t-&gt;install($names);
    }
    
    public static function textdomain($domain=null) {
        if (!is_null($domain))
            self::$current_domain = $domain;
        return self::$current_domain;
    }
    
    public static function bindtextdomain($domain, $localedir=null) {
        if (!is_null($localedir))
            self::$localedirs[$domain] = $localedir;
        if (isset(self::$localedirs[$domain]))
            return self::$localedirs[$domain];
        return self::$default_localedir;
    }
    
    public static function bind_textdomain_codeset($domain, $codeset=null) {
        if (!is_null($codeset))
            self::$localecodesets[$domain] = $codeset;
        if (isset(self::$localecodesets[$domain]))
            return self::$localecodesets[$domain];
        throw new \OutOfBoundsException($domain);
    }
    
    public static function dgettext($domain, $msg) {
        $localedir = self::get_localedir_or_null($domain);
        $codeset = self::get_codeset_or_null($domain);
        try {
            $t = self::translation($domain, $localedir, null, null, false, $codeset);
        } catch (\gettext\IOError $e) {
            return $msg;
        }
        return $t-&gt;gettext($msg);
    }
    
    public static function ldgettext($domain, $msg) {
        $localedir = self::get_localedir_or_null($domain);
        $codeset = self::get_codeset_or_null($domain);
        try {
            $t = self::translation($domain, $localedir, null, null, false, $codeset);
        } catch (\gettext\IOError $e) {
            return $msg;
        }
        return $t-&gt;lgettext($msg);
    }
    
    public static function dngettext($domain, $msg1, $msg2, $n) {
        $localedir = self::get_localedir_or_null($domain);
        $codeset = self::get_codeset_or_null($domain);
        try {
            $t = self::translation($domain, $localedir, null, null, false, $codeset);
        } catch (\gettext\IOError $e) {
            if ($n == 1)
                return $msg1;
            return $msg2;
        }
        return $t-&gt;ngettext($msg1, $msg2, $n);
    }
    
    public static function ldngettext($domain, $msg1, $msg2, $n) {
        $localedir = self::get_localedir_or_null($domain);
        $codeset = self::get_codeset_or_null($domain);
        try {
            $t = self::translation($domain, $localedir, null, null, false, $codeset);
        } catch (\gettext\IOError $e) {
            if ($n == 1)
                return $msg1;
            return $msg2;
        }
        return $t-&gt;lngettext($msg1, $msg2, $n);
    }
    
    /*
        cannot declare these shortcuts because php thinks gettext() is 
        a constructor (even though it is declared static). oh well.
    
    public static function gettext($msg) {
        return self::dgettext(self::$current_domain, $msg);
    }
    
    public static function lgettext($msg) {
        return self::ldgettext(self::$current_domain, $msg);
    }
    
    public static function ngettext($msg1, $msg2, $n) {
        return self::dngettext(self::$current_domain, $msg1, $msg2, $n);
    }
    
    public static function lngettext($msg1, $msg2, $n) {
        return self::ldngettext(self::$current_domain, $msg1, $msg2, $n);
    }
    */
    
    private static function get_localedir_or_null($domain) {
        if (isset(self::$localedirs[$domain]))
            return self::$localedirs[$domain];
        return null;
    }
    
    private static function get_codeset_or_null($domain) {
        if (isset(self::$localecodesets[$domain]))
            return self::$localecodesets[$domain];
        return null;
    }
    
    private static function expand_lang($loc) {
        $COMPONENT_CODESET   = 1 &lt;&lt; 0;
        $COMPONENT_TERRITORY = 1 &lt;&lt; 1;
        $COMPONENT_MODIFIER  = 1 &lt;&lt; 2;
        
        // split up the locale into its base components
        $mask = 0;
        $pos = strpos($loc, &quot;@&quot;);
        if (false !== $pos) {
            $modifier = substr($loc, $pos);
            $loc = substr($loc, 0, $pos);
            $mask |= $COMPONENT_MODIFIER;
        } else {
            $modifier = &quot;&quot;;
        }
        $pos = strpos($loc, &quot;.&quot;);
        if (false !== $pos) {
            $codeset = substr($loc, $pos);
            $loc = substr($loc, 0, $pos);
            $mask |= $COMPONENT_CODESET;
        } else {
            $codeset = &quot;&quot;;
        }
        $pos = strpos($loc, &quot;_&quot;);
        if (false !== $pos) {
            $territory = substr($loc, $pos);
            $loc = substr($loc, 0, $pos);
            $mask |= $COMPONENT_TERRITORY;
        } else {
            $territory = &quot;&quot;;
        }
        
        $language = $loc;
        $ret = array();
        for ($i = 0; $i &lt; $mask+1; $i++) { 
            if (!($i &amp; ~$mask)) { // if all components for this combo exist ...
                $val = $language;
                if ($i &amp; $COMPONENT_TERRITORY) $val .= $territory;
                if ($i &amp; $COMPONENT_CODESET)   $val .= $codeset;
                if ($i &amp; $COMPONENT_MODIFIER)  $val .= $modifier;
                $ret[] = $val;
            }
        }
        
        return array_reverse($ret);
    }
}

}

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>

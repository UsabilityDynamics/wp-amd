<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>core/premium/client-dashboard/js/flawless.login_module.js - flawless</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http://a3d72a45d111006ec192-ec5b80a12b0b09b4d52373336afb4254.r80.cf1.rackcdn.com/usability-dynamics.png" title="flawless"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/: Flawless.API.html">: Flawless.API</a></li>
            
                <li><a href="../classes/: Flawless.Element.html">: Flawless.Element</a></li>
            
                <li><a href="../classes/: Flawless.Flawless_Module.html">: Flawless.Flawless_Module</a></li>
            
                <li><a href="../classes/: Flawless.License.html">: Flawless.License</a></li>
            
                <li><a href="../classes/Flawless.BuddyPress.html">Flawless.BuddyPress</a></li>
            
                <li><a href="../classes/Flawless.Flawless\Shortcode.html">Flawless.Flawless\Shortcode</a></li>
            
                <li><a href="../classes/Flawless.Flawless\Widget.html">Flawless.Flawless\Widget</a></li>
            
                <li><a href="../classes/flawless_wpp_extensions.html">flawless_wpp_extensions</a></li>
            
                <li><a href="../classes/Shortcode.html">Shortcode</a></li>
            
                <li><a href="../classes/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../classes/Theme.html">Theme</a></li>
            
                <li><a href="../classes/Theme UI.html">Theme UI</a></li>
            
                <li><a href="../classes/UD.API.html">UD.API</a></li>
            
                <li><a href="../classes/UD.Utility.html">UD.Utility</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Core Assets.html">Core Assets</a></li>
            
                <li><a href="../modules/Flawless.html">Flawless</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: core/premium/client-dashboard/js/flawless.login_module.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/* =========================================================
 * flawless-login-module.js
 * http://usabilitydynamics.com
 * =========================================================
 * Copyright 2011 Usability Dynamics, Inc.
 *
 * Version 0.0.1
 *
 * Copyright ( c ) 2011 Usability Dynamics, Inc. ( usabilitydynamics.com )
 * ========================================================= */

var flawless = flawless ? flawless : {};

/**
 * Renders notice.
 * @author potanin@UD
 */
if ( typeof flawless.toggle_password_reset != &#x27;function&#x27; ) {
  flawless.toggle_password_reset = function ( event, el ) {
    var wrap = jQuery( &#x27;div.nav-collapse.pull-right ul&#x27; );
    el = jQuery( el );

    el.trigger( &#x27;flawless::nav_forget_password&#x27; );

    jQuery( &#x27;.navbar_login_form .flawless_ajax_response&#x27;, wrap ).hide();
    jQuery( &#x27;.navbar_login_form&#x27;, wrap ).toggleClass( &#x27;hidden&#x27; );
    jQuery( &#x27;.navbar_reset_password_form&#x27;, wrap ).toggleClass( &#x27;hidden&#x27; );

    if ( jQuery( &#x27;.navbar_login_form&#x27;, wrap ).is( &#x27;:visible&#x27; ) ) {
      jQuery( &#x27;.navbar_login_form input.user_login&#x27; ).focus();
    }

    if ( jQuery( &#x27;.navbar_reset_password_form&#x27;, wrap ).is( &#x27;:visible&#x27; ) ) {
      jQuery( &#x27;.navbar_reset_password_form input.user_login&#x27; ).focus();
      if ( jQuery( &#x27;.navbar_reset_password_form input.user_login&#x27; ).val() === &#x27;&#x27; ) {
        jQuery( &#x27;.navbar_reset_password_form input.user_login&#x27; ).val( jQuery( &#x27;.navbar_login_form input.user_login&#x27; ).val() );
      }
    }
  }
}

/**
 * Renders notice.
 *
 * @todo Finish popover integration. - potanin@UD
 * @param string text. HTML
 * @param object el. Optional DOM element
 * @author peshkov@UD
 */
if ( typeof flawless.navbar_login_notice != &#x27;function&#x27; ) {
  flawless.navbar_login_notice = function ( text, container, type, doing ) {

    var primary_notice_container = jQuery( &#x27;.primary_notice_container&#x27; );
    type = typeof type === &#x27;string&#x27; ? type : &#x27;success&#x27;;
    container = container ? container : jQuery( &#x27;.flawless_ajax_response&#x27; );

    if ( !container.length ) {
      return;
    }

    flawless.navbar_login_notice.schedule_hide = function () {
      flawless.navbar_login_notice.hide = setTimeout( function () {
        container.fadeOut( 2000 );
      }, 5000 );
    }

    flawless.navbar_login_notice.cancel_hide = function () {
      container.fadeIn( 100 )
      clearTimeout( flawless.navbar_login_notice.hide );
    }

    container.removeClass( &#x27;label-important&#x27; ).removeClass( &#x27;label-success&#x27; ).removeClass( &#x27;hidden&#x27; );

    container.html( text );

    switch ( type ) {

      case &#x27;success&#x27;:
        container.addClass( &#x27;label-success&#x27; );

        /** Pause and then show the sign in form */
        if ( doing === &#x27;password_reset&#x27; ) {
          container.append( flawless.progress_bar( { type: &#x27;success&#x27;, frequency: 200 }, function () {
            flawless.toggle_password_reset();
            jQuery( &#x27;.flawless_navbar_form input[type=&quot;text&quot;]&#x27; ).val( &#x27;&#x27; );
          } ) );
        }

        break;

      default:

        container.addClass( &#x27;label-important&#x27; );

        if ( !jQuery( &#x27;.forget_password_link&#x27;, container ).length ) {
          container.append( container.reset_trigger = jQuery( &#x27;&lt;a href=&quot;#&quot; class=&quot;forget_password_link&quot;&gt;&#x27; + lm_l10n.forget_password + &#x27;&lt;/a&gt;&#x27; ) );

          jQuery( container.reset_trigger ).click( function () {
            jQuery( document ).trigger( &#x27;flawless::track_event&#x27;, { category: &#x27;Navbar User Action&#x27;, action: &#x27;Forget Password Link&#x27;, label: &#x27;After Failure&#x27; } );
            flawless.toggle_password_reset();
          } );

        }

        break;

    }

    jQuery( container ).hover( function () {
      flawless.navbar_login_notice.cancel_hide();
    }, function () {
      flawless.navbar_login_notice.schedule_hide();
    } );

    if ( !flawless.navbar_login_notice.hide ) {
      flawless.navbar_login_notice.schedule_hide();
    }

  }
}

jQuery( document ).ready( function () {

  /**
   * Switch log in / forget password forms in navbar.
   *
   * @author peshkov@UD
   */
  jQuery( &#x27;a#nav_forget_password&#x27; ).click( function ( event ) {
    event.preventDefault();
    jQuery( document ).trigger( &#x27;flawless::track_event&#x27;, { category: &#x27;Navbar User Action&#x27;, action: &#x27;Forget Password Link&#x27;, label: &#x27;Before Failure&#x27; } );
    flawless.toggle_password_reset( this );
  } );


  /**
   * &#x27;Forget password&#x27; AJAX form submitting
   *
   * @author peshkov@UD
   */
  jQuery( &#x27;form[name=&quot;flawless_password_reset_form&quot;]&#x27; ).submit( function ( e ) {
    e.preventDefault();
    jQuery( this ).trigger( &#x27;flawless::reset_password_submit&#x27; );
    var nwrap = jQuery( &#x27;.flawless_ajax_response&#x27;, this );

    /** Validate form data */
    if ( jQuery( &#x27;input[name=&quot;user_login&quot;]&#x27;, this ).val() === &#x27;&#x27; ) {
      flawless.navbar_login_notice( lm_l10n.enter_fields_properly, nwrap, &#x27;error&#x27;, &#x27;password_reset&#x27; );
      return false;
    }

    jQuery.ajax( {
      &#x27;url&#x27;: flawless.ajax_url,
      &#x27;dataType&#x27;: &#x27;json&#x27;,
      &#x27;type&#x27;: &#x27;POST&#x27;,
      &#x27;data&#x27;: jQuery( this ).serialize(),
      &#x27;success&#x27;: function ( data, textStatus ) {

        if ( !!data.success ) {
          jQuery( document ).trigger( &#x27;flawless::track_event&#x27;, { category: &#x27;Navbar Password Reset&#x27;, action: &#x27;Fail&#x27;, label: &#x27;Unknown Failure&#x27; } );
          flawless.navbar_login_notice( lm_l10n.something_wrong, nwrap, &#x27;error&#x27;, &#x27;password_reset&#x27; );
        }

        if ( data.success === true ) {
          jQuery( document ).trigger( &#x27;flawless::track_event&#x27;, { category: &#x27;Navbar Password Reset&#x27;, action: &#x27;Success&#x27; } );
          flawless.navbar_login_notice( lm_l10n.email_was_sent, nwrap, &#x27;success&#x27;, &#x27;password_reset&#x27; );
        } else {
          jQuery( document ).trigger( &#x27;flawless::track_event&#x27;, { category: &#x27;Navbar Password Reset&#x27;, action: &#x27;Fail&#x27;, label: data.error } );
          flawless.navbar_login_notice( data.error, nwrap, &#x27;error&#x27;, &#x27;password_reset&#x27; );
        }

      }

    } );

  } );


  /**
   * Logout AJAX functionality
   *
   * @author peshkov@UD
   */
  jQuery( &#x27;a.f_ajax_logout_link&#x27; ).click( function ( e ) {
    e.preventDefault();
    jQuery( this ).trigger( &#x27;flawless::log_out&#x27; );
    /** Now do request */
    jQuery.ajax( {
      &#x27;url&#x27;: flawless.ajax_url,
      &#x27;type&#x27;: &#x27;POST&#x27;,
      &#x27;data&#x27;: {&#x27;action&#x27;: &#x27;flawless_ajax_logout&#x27;},
      &#x27;complete&#x27;: function ( r, status ) {
        window.location.reload( true );
      }
    } );
    return false;
  } );


  /**
   * &#x27;Log in&#x27; AJAX form submitting
   *
   * @author peshkov@UD
   */
  jQuery( &#x27;form[name=&quot;flawless_login_form&quot;]&#x27; ).submit( function ( e ) {
    e.preventDefault();

    jQuery( document ).trigger( &#x27;flawless::login_form_submit&#x27; );
    var nwrap = jQuery( &#x27;.flawless_ajax_response&#x27;, this );

    /** Validate form data */
    if ( jQuery( &#x27;input[name=&quot;log&quot;]&#x27;, this ).val() === &#x27;&#x27; ) {
      return flawless.navbar_login_notice( lm_l10n.enter_login, nwrap, &#x27;error&#x27;, &#x27;login&#x27; );
    } else if ( jQuery( &#x27;input[name=&quot;pwd&quot;]&#x27;, this ).val() === &#x27;&#x27; ) {
      return flawless.navbar_login_notice( lm_l10n.enter_password, nwrap, &#x27;error&#x27;, &#x27;login&#x27; );
    }

    /** Now do request */
    jQuery.ajax( {
      &#x27;url&#x27;: flawless.ajax_url,
      &#x27;dataType&#x27;: &#x27;json&#x27;,
      &#x27;type&#x27;: &#x27;POST&#x27;,
      &#x27;data&#x27;: jQuery( this ).serialize(),
      &#x27;success&#x27;: function ( data, textStatus ) {

        if ( typeof data.success === &#x27;undefined&#x27; ) {
          jQuery( document ).trigger( &#x27;flawless::track_event&#x27;, { category: &#x27;Navbar Login&#x27;, action: &#x27;Failure&#x27;, label: lm_l10n.something_wrong.error } );
          flawless.navbar_login_notice( lm_l10n.something_wrong, nwrap, &#x27;error&#x27;, &#x27;login&#x27; );
        }

        if ( data.success === true ) {
          jQuery( document ).trigger( &#x27;flawless::track_event&#x27;, { category: &#x27;Navbar Login&#x27;, action: &#x27;Success&#x27; } );

          if ( data.redirect_to ) {
            window.location.href = data.redirect_to;

          } else {
            window.location.reload( true );
          }

        } else {
          jQuery( document ).trigger( &#x27;flawless::track_event&#x27;, { category: &#x27;Navbar Login&#x27;, action: &#x27;Failure&#x27;, label: data.error } );
          flawless.navbar_login_notice( data.error, nwrap, &#x27;error&#x27;, &#x27;login&#x27; );
        }

      }

    } );

  } );
} );


    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>

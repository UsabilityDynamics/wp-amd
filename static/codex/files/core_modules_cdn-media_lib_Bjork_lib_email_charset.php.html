<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>core/modules/cdn-media/lib/Bjork/lib/email/charset.php - wp-flawless</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http://a3d72a45d111006ec192-ec5b80a12b0b09b4d52373336afb4254.r80.cf1.rackcdn.com/usability-dynamics.png" title="wp-flawless"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/API.html">API</a></li>
            
                <li><a href="../classes/Carrington.html">Carrington</a></li>
            
                <li><a href="../classes/Extended_Taxonomies.html">Extended_Taxonomies</a></li>
            
                <li><a href="../classes/Flawless.API.html">Flawless.API</a></li>
            
                <li><a href="../classes/Flawless.Asset.html">Flawless.Asset</a></li>
            
                <li><a href="../classes/Flawless.Branded_Login.html">Flawless.Branded_Login</a></li>
            
                <li><a href="../classes/Flawless.BuddyPress.html">Flawless.BuddyPress</a></li>
            
                <li><a href="../classes/Flawless.Content.html">Flawless.Content</a></li>
            
                <li><a href="../classes/Flawless.Element.html">Flawless.Element</a></li>
            
                <li><a href="../classes/Flawless.Flawless\Shortcode.html">Flawless.Flawless\Shortcode</a></li>
            
                <li><a href="../classes/Flawless.Management.html">Flawless.Management</a></li>
            
                <li><a href="../classes/Flawless.Mobile.html">Flawless.Mobile</a></li>
            
                <li><a href="../classes/Flawless.Navbars.html">Flawless.Navbars</a></li>
            
                <li><a href="../classes/Flawless.Schema.html">Flawless.Schema</a></li>
            
                <li><a href="../classes/Flawless.Settings.html">Flawless.Settings</a></li>
            
                <li><a href="../classes/Flawless.Styles.html">Flawless.Styles</a></li>
            
                <li><a href="../classes/Flawless.Utility.html">Flawless.Utility</a></li>
            
                <li><a href="../classes/Flawless.Widget.html">Flawless.Widget</a></li>
            
                <li><a href="../classes/flawless_wpp_extensions.html">flawless_wpp_extensions</a></li>
            
                <li><a href="../classes/Legacy.html">Legacy</a></li>
            
                <li><a href="../classes/License.html">License</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Log.html">Log</a></li>
            
                <li><a href="../classes/Maintenance.html">Maintenance</a></li>
            
                <li><a href="../classes/Models.html">Models</a></li>
            
                <li><a href="../classes/Module.html">Module</a></li>
            
                <li><a href="../classes/Multisite.html">Multisite</a></li>
            
                <li><a href="../classes/SaaS.html">SaaS</a></li>
            
                <li><a href="../classes/Shortcode.html">Shortcode</a></li>
            
                <li><a href="../classes/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../classes/Template Methods.html">Template Methods</a></li>
            
                <li><a href="../classes/Theme.html">Theme</a></li>
            
                <li><a href="../classes/UI.html">UI</a></li>
            
                <li><a href="../classes/Utility.html">Utility</a></li>
            
                <li><a href="../classes/Views.html">Views</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/API.html">API</a></li>
            
                <li><a href="../modules/Branded Login.html">Branded Login</a></li>
            
                <li><a href="../modules/Carrington.html">Carrington</a></li>
            
                <li><a href="../modules/Carrington Build.html">Carrington Build</a></li>
            
                <li><a href="../modules/carrington-build.html">carrington-build</a></li>
            
                <li><a href="../modules/cfct_build.html">cfct_build</a></li>
            
                <li><a href="../modules/default.html">default</a></li>
            
                <li><a href="../modules/Flawless.html">Flawless</a></li>
            
                <li><a href="../modules/Loader.html">Loader</a></li>
            
                <li><a href="../modules/Log.html">Log</a></li>
            
                <li><a href="../modules/Maintenence.html">Maintenence</a></li>
            
                <li><a href="../modules/Management.html">Management</a></li>
            
                <li><a href="../modules/Multisite.html">Multisite</a></li>
            
                <li><a href="../modules/SaaS.html">SaaS</a></li>
            
                <li><a href="../modules/Services_JSON.html">Services_JSON</a></li>
            
                <li><a href="../modules/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

Released under the GPL license
http:__www.opensource.org_licenses_gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

Released under the GPL license
http://www.opensource.org/licenses/gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/Theme UI.html">Theme UI</a></li>
            
                <li><a href="../modules/UI.html">UI</a></li>
            
                <li><a href="../modules/UsabilityDynamics.html">UsabilityDynamics</a></li>
            
                <li><a href="../modules/Utility.html">Utility</a></li>
            
                <li><a href="../modules/Views.html">Views</a></li>
            
                <li><a href="../modules/WP-Property.html">WP-Property</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: core/modules/cdn-media/lib/Bjork/lib/email/charset.php</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&lt;?php

namespace email\charset {

use email\charset as base;

class Charset {
    
    protected
        $input_charset,
        $input_codec,
        $output_charset,
        $output_codec,
        $header_encoding,
        $body_encoding;
    
    function __construct($input_charset=charset::DEFAULT_CHARSET) {
        $input_charset = strtolower($input_charset);
        $this-&gt;input_charset = base::get_alias($input_charset, $input_charset);
        // We can try to guess which encoding and conversion to use by the
        // charset_map dictionary. Try that first, but let the user override
        // it.
        list($henc, $benc, $conv) = base::get_charset($this-&gt;input_charset);
        if (!$conv)
            $conv = $this-&gt;input_charset;
        // Set the attributes, allowing the arguments to override the default.
        $this-&gt;header_encoding = $henc;
        $this-&gt;body_encoding = $benc;
        $this-&gt;output_charset = base::get_alias($conv, $conv);
        $this-&gt;input_codec = base::get_codec($this-&gt;input_charset, $this-&gt;input_charset);
        $this-&gt;output_codec = base::get_codec($this-&gt;output_charset, $this-&gt;output_charset);
    }
    
    function __toString() {
        return strtolower($this-&gt;input_charset);
    }
    
    public function getInputCharset() {
        return $this-&gt;input_charset;
    }
    
    public function getOutputCharset() {
        return $this-&gt;output_charset ?: $this-&gt;input_charset;
    }
    
    public function getMIMEOutputCharset() {
        return mb_preferred_mime_name($this-&gt;getOutputCharset());
    }
    
    public function getInputCodec() {
        return $this-&gt;input_codec;
    }
    
    public function getOutputCodec() {
        return $this-&gt;output_codec;
    }
    
    public function getHeaderEncoding() {
        return $this-&gt;header_encoding;
    }
    
    public function getBodyEncoding() {
        return $this-&gt;body_encoding;
    }
    
    /**
    * Return the content-transfer-encoding used for body encoding.
    * 
    * This is either the string &#x60;quoted-printable&#x27; or &#x60;base64&#x27; depending on
    * the encoding used, or it is null in which case you should call
    * the charset::encode_7or8bit function with a single argument,
    * the Message object being encoded. The function should then set the
    * Content-Transfer-Encoding header itself to whatever is appropriate.
    * 
    * Returns &quot;quoted-printable&quot; if self.body_encoding is QP.
    * Returns &quot;base64&quot; if self.body_encoding is BASE64.
    * Returns null otherwise.
    */
    public function getBodyTransferEncoding() {
        $benc = null;
        if (base::QP === $this-&gt;body_encoding)
            $benc = &#x27;quoted-printable&#x27;;
        else if (base::BASE64 === $this-&gt;body_encoding)
            $benc = &#x27;base64&#x27;;
        else if (base::SHORTEST === $this-&gt;body_encoding)
            throw new \InvalidArgumentException(&#x27;SHORTEST not allowed for body_enc&#x27;);
        return $benc;
    }
    
    /**
    * Convert a string from the input_codec to the output_codec.
    */
    public function convert($s) {
        if ($this-&gt;input_codec != $this-&gt;output_codec)
            return mb_convert_encoding($s, $this-&gt;output_codec, $this-&gt;input_codec);
        return $s;
    }
    
    /**
    * Header-encode a string, optionally converting it to output_charset.
    * 
    * If convert is True, the string will be converted from the input
    * charset to the output charset automatically.  This is not useful for
    * multibyte character sets, which have line length issues (multibyte
    * characters must be split on a character, not a byte boundary); use the
    * high-level Header class to deal with these issues.  convert defaults
    * to False.
    * 
    * The type of encoding (base64 or quoted-printable) will be based on
    * self.header_encoding.
    */
    public function headerEncode($s, $convert=false) {
        $cset = $this-&gt;getOutputCharset();
        if ($convert)
            $s = $this-&gt;convert($s);
        if (base::BASE64 === $this-&gt;header_encoding)
            $transfer_encoding = &#x27;B&#x27;;
        else if (base::QP === $this-&gt;header_encoding)
            $transfer_encoding = &#x27;Q&#x27;;
        else if (base::SHORTEST === $this-&gt;header_encoding) {
            // @TODO: actually figure out both lengths and pick the
            //        one that produces the shortest string. for now
            //        set transfer_encoding to base64 as it&#x27;s safer.
            $transfer_encoding = &#x27;B&#x27;;
        } else {
            // 7bit/8bit encodings return the string unchanged
            return $s;
        }
        return mb_encode_mimeheader($s, $cset, $transfer_encoding);
    }
    
    /**
    * Body-encode a string and convert it to output_charset.
    * 
    * If convert is True (the default), the string will be converted from
    * the input charset to output charset automatically.  Unlike
    * header_encode(), there are no issues with byte boundaries and
    * multibyte charsets in email bodies, so this is usually pretty safe.
    * 
    * The type of encoding (base64 or quoted-printable) will be based on
    * self.body_encoding.
    */
    public function bodyEncode($s, $convert=true) {
        if ($convert)
            $s = $this-&gt;convert($s);
        if (base::BASE64 === $this-&gt;body_encoding)
            $encoding = &#x27;BASE64&#x27;;
        else if (base::QP === $this-&gt;body_encoding)
            $encoding = &#x27;Quoted-Printable&#x27;;
        else
            // 7bit/8bit encodings return the string unchanged
            return $s;
        
        return mb_convert_encoding($s, $encoding);
    }
}

}

namespace email {

final class charset {
    
    // Flags for types of header encodings
    const QP       = 1; // Quoted-Printable
    const BASE64   = 2; // Base64
    const SHORTEST = 3; // the shorter of QP and base64, but only for headers
    
    // In &quot;=?charset?q?hello_world?=&quot;, the =?, ?q?, and ?= add up to 7
    const MISC_LEN = 7;
    
    const DEFAULT_CHARSET = &#x27;us-ascii&#x27;;
    
    static
        // for these see self::init()
        $_CHARSETS = null,
        $_ALIASES = null,
        $_CODEC_MAP = null;
    
    /**
    * Add character set properties to the global registry.
    * 
    * charset is the input character set, and must be the canonical name of a
    * character set.
    * 
    * Optional header_enc and body_enc is either Charset.QP for
    * quoted-printable, Charset.BASE64 for base64 encoding, Charset.SHORTEST for
    * the shortest of qp or base64 encoding, or null for no encoding.  SHORTEST
    * is only valid for header_enc.  It describes how message headers and
    * message bodies in the input charset are to be encoded.  Default is no
    * encoding.
    * 
    * Optional output_charset is the character set that the output should be
    * in.  Conversions will proceed from input charset, to Unicode, to the
    * output charset when the method Charset.convert() is called.  The default
    * is to output in the same character set as the input.
    * 
    * Both input_charset and output_charset must have Unicode codec entries in
    * the module&#x27;s charset-to-codec mapping; use add_codec(charset, codecname)
    * to add codecs the module does not know about.  See the codecs module&#x27;s
    * documentation for more information.
    */
    public static function add_charset($charset, $header_enc=null, $body_enc=null, $output_charset=null) {
        self::init();
        if ($body_enc === self::SHORTEST)
            throw new \InvalidArgumentException(&#x27;SHORTEST not allowed for body_enc&#x27;);
        self::$_CHARSETS[$charset] = array($header_enc, $body_enc, $output_charset);
    }
    
    /**
    * Add a character set alias.
    * 
    * alias is the alias name, e.g. latin-1
    * canonical is the character set&#x27;s canonical name, e.g. iso-8859-1
    */
    public static function add_alias($alias, $canonical) {
        self::init();
        self::$_ALIASES[$alias] = $canonical;
    }
    
    /**
    * Add a codec that map characters in the given charset to/from Unicode.
    * 
    * charset is the canonical name of a character set.  codecname is the name
    * of a Python codec, as appropriate for the second argument to the unicode()
    * built-in, or to the encode() method of a Unicode string.
    */
    public static function add_codec($charset, $codecname) {
        self::init();
        self::$_CODEC_MAP[$charset] = $codecname;
    }
    
    public static function get_charset($charset, array $default=null) {
        self::init();
        $charset_lower = strtolower($charset);
        if (array_key_exists($charset_lower, self::$_CHARSETS))
            return self::$_CHARSETS[$charset_lower];
        if (null === $default)
            return array(self::SHORTEST, self::BASE64, null);
        return $default;
    }
    
    public static function get_alias($charset, $default=null) {
        self::init();
        $charset_lower = strtolower($charset);
        if (array_key_exists($charset_lower, self::$_ALIASES))
            return self::$_ALIASES[$charset_lower];
        return $default;
    }
    
    public static function get_codec($charset, $default=null) {
        self::init();
        $charset_lower = strtolower($charset);
        if (array_key_exists($charset_lower, self::$_CODEC_MAP))
            return self::$_CODEC_MAP[$charset_lower];
        return $default;
    }
    
    static function init() {
        if (null !== self::$_CHARSETS)
            return;
        
        self::$_CHARSETS = array(
            // input                header enc      body enc     output conv
            &#x27;iso-8859-1&#x27;    =&gt; array(self::QP,      self::QP,      null),
            &#x27;iso-8859-2&#x27;    =&gt; array(self::QP,      self::QP,      null),
            &#x27;iso-8859-3&#x27;    =&gt; array(self::QP,      self::QP,      null),
            &#x27;iso-8859-4&#x27;    =&gt; array(self::QP,      self::QP,      null),
            // iso-8859-5 is Cyrillic, and not especially used
            // iso-8859-6 is Arabic, also not particularly used
            // iso-8859-7 is Greek, QP will not make it readable
            // iso-8859-8 is Hebrew, QP will not make it readable
            &#x27;iso-8859-9&#x27;    =&gt; array(self::QP,      self::QP,      null),
            &#x27;iso-8859-10&#x27;   =&gt; array(self::QP,      self::QP,      null),
            // iso-8859-11 is Thai, QP will not make it readable
            &#x27;iso-8859-13&#x27;   =&gt; array(self::QP,      self::QP,      null),
            &#x27;iso-8859-14&#x27;   =&gt; array(self::QP,      self::QP,      null),
            &#x27;iso-8859-15&#x27;   =&gt; array(self::QP,      self::QP,      null),
            &#x27;iso-8859-16&#x27;   =&gt; array(self::QP,      self::QP,      null),
            &#x27;windows-1252&#x27;  =&gt; array(self::QP,      self::QP,      null),
            &#x27;us-ascii&#x27;      =&gt; array(null,          null,          null),
            &#x27;big5&#x27;          =&gt; array(self::BASE64,  self::BASE64,  null),
            &#x27;gb2312&#x27;        =&gt; array(self::BASE64,  self::BASE64,  null),
            &#x27;euc-jp&#x27;        =&gt; array(self::BASE64,  null,          &#x27;iso-2022-jp&#x27;),
            &#x27;shift_jis&#x27;     =&gt; array(self::BASE64,  null,          &#x27;iso-2022-jp&#x27;),
            &#x27;iso-2022-jp&#x27;   =&gt; array(self::BASE64,  null,          null),
            &#x27;koi8-r&#x27;        =&gt; array(self::BASE64,  self::BASE64,  null),
            &#x27;utf-8&#x27;         =&gt; array(self::SHORTEST, self::BASE64, &#x27;utf-8&#x27;),
            // We&#x27;re making this one up to represent raw unencoded 8-bit
            &#x27;8bit&#x27;          =&gt; array(null,          self::BASE64,  &#x27;utf-8&#x27;),
        );
        
        // Aliases for other commonly-used names for character sets. Map
        // them to the real ones used in email.
        self::$_ALIASES = array(
            &#x27;latin_1&#x27;  =&gt; &#x27;iso-8859-1&#x27;,
            &#x27;latin-1&#x27;  =&gt; &#x27;iso-8859-1&#x27;,
            &#x27;latin_2&#x27;  =&gt; &#x27;iso-8859-2&#x27;,
            &#x27;latin-2&#x27;  =&gt; &#x27;iso-8859-2&#x27;,
            &#x27;latin_3&#x27;  =&gt; &#x27;iso-8859-3&#x27;,
            &#x27;latin-3&#x27;  =&gt; &#x27;iso-8859-3&#x27;,
            &#x27;latin_4&#x27;  =&gt; &#x27;iso-8859-4&#x27;,
            &#x27;latin-4&#x27;  =&gt; &#x27;iso-8859-4&#x27;,
            &#x27;latin_5&#x27;  =&gt; &#x27;iso-8859-9&#x27;,
            &#x27;latin-5&#x27;  =&gt; &#x27;iso-8859-9&#x27;,
            &#x27;latin_6&#x27;  =&gt; &#x27;iso-8859-10&#x27;,
            &#x27;latin-6&#x27;  =&gt; &#x27;iso-8859-10&#x27;,
            &#x27;latin_7&#x27;  =&gt; &#x27;iso-8859-13&#x27;,
            &#x27;latin-7&#x27;  =&gt; &#x27;iso-8859-13&#x27;,
            &#x27;latin_8&#x27;  =&gt; &#x27;iso-8859-14&#x27;,
            &#x27;latin-8&#x27;  =&gt; &#x27;iso-8859-14&#x27;,
            &#x27;latin_9&#x27;  =&gt; &#x27;iso-8859-15&#x27;,
            &#x27;latin-9&#x27;  =&gt; &#x27;iso-8859-15&#x27;,
            &#x27;latin_10&#x27; =&gt; &#x27;iso-8859-16&#x27;,
            &#x27;latin-10&#x27; =&gt; &#x27;iso-8859-16&#x27;,
            &#x27;ascii&#x27;    =&gt; &#x27;us-ascii&#x27;,
        );
        
        // Map charsets to their Unicode codec strings.
        self::$_CODEC_MAP = array(
            // Hack: We don&#x27;t want *any* conversion for stuff marked us-ascii, as all
            // sorts of garbage might be sent to us in the guise of 7-bit us-ascii.
            // Let that stuff pass through without conversion to/from Unicode.
            &#x27;us-ascii&#x27;  =&gt; null,
        );
    }
}
    
}

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>

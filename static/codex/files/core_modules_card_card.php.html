<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>core/modules/card/card.php - flawless</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http://a3d72a45d111006ec192-ec5b80a12b0b09b4d52373336afb4254.r80.cf1.rackcdn.com/usability-dynamics.png" title="flawless"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/: Flawless.API.html">: Flawless.API</a></li>
            
                <li><a href="../classes/: Flawless.Element.html">: Flawless.Element</a></li>
            
                <li><a href="../classes/: Flawless.Flawless_Module.html">: Flawless.Flawless_Module</a></li>
            
                <li><a href="../classes/: Flawless.License.html">: Flawless.License</a></li>
            
                <li><a href="../classes/Flawless.BuddyPress.html">Flawless.BuddyPress</a></li>
            
                <li><a href="../classes/Flawless.Flawless\Shortcode.html">Flawless.Flawless\Shortcode</a></li>
            
                <li><a href="../classes/Flawless.Flawless\Widget.html">Flawless.Flawless\Widget</a></li>
            
                <li><a href="../classes/flawless_wpp_extensions.html">flawless_wpp_extensions</a></li>
            
                <li><a href="../classes/Shortcode.html">Shortcode</a></li>
            
                <li><a href="../classes/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../classes/Theme.html">Theme</a></li>
            
                <li><a href="../classes/Theme UI.html">Theme UI</a></li>
            
                <li><a href="../classes/UD.API.html">UD.API</a></li>
            
                <li><a href="../classes/UD.Utility.html">UD.Utility</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Core Assets.html">Core Assets</a></li>
            
                <li><a href="../modules/Flawless.html">Flawless</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: core/modules/card/card.php</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&lt;?php
/**
 * Name: Business Card
 * Version: 1.0
 * Description: Widgets for the Flawless theme.
 * Author: Usability Dynamics, Inc.
 * Theme Feature: header-business-card
 *
 */

add_action( &#x27;Flawless_setup&#x27;, array( &#x27;flawless_business_card&#x27;, &#x27;Flawless_setup&#x27; ) );
add_filter( &#x27;flawless::available_theme_features&#x27;, array( &#x27;flawless_business_card&#x27;, &#x27;available_theme_features&#x27; ) );

class flawless_business_card {

  function Flawless_setup() {
    add_action( &#x27;flawless::init_upper&#x27;, array( &#x27;flawless_business_card&#x27;, &#x27;init_upper&#x27; ) );
    add_action( &#x27;flawless::init_lower&#x27;, array( &#x27;flawless_business_card&#x27;, &#x27;init_lower&#x27; ) );

  }

  function init_upper() {

    if ( !current_theme_supports( &#x27;header-business-card&#x27; ) ) {
      return;
    }

    //** Add business card widget */
    add_action( &#x27;widgets_init&#x27;, array( &#x27;flawless_business_card&#x27;, &#x27;widgets_init&#x27; ) );

  }

  function init_lower() {

    if ( !current_theme_supports( &#x27;header-business-card&#x27; ) ) {
      return;
    }

    //** Add administrative actions */
    add_action( &#x27;admin_init&#x27;, array( &#x27;flawless_business_card&#x27;, &#x27;admin_init&#x27; ) );

    add_filter( &#x27;flawless_option_tabs&#x27;, array( &#x27;flawless_business_card&#x27;, &#x27;flawless_option_tabs&#x27; ) );

    add_filter( &#x27;flawless_default_settings&#x27;, array( &#x27;flawless_business_card&#x27;, &#x27;flawless_default_settings&#x27; ) );

    add_filter( &#x27;flawless_update_settings&#x27;, array( &#x27;flawless_business_card&#x27;, &#x27;flawless_update_settings&#x27; ) );

  }

  function admin_init() {

    //** Add Business Card to header configuration */
    add_filter( &#x27;flawless_option_header_elements&#x27;, array( &#x27;flawless_business_card&#x27;, &#x27;flawless_option_header_elements&#x27; ) );

  }

  /**
   * {}
   *
   */
  function available_theme_features( $features ) {
    $features[ &#x27;header-business-card&#x27; ] = true;
    return $features;
  }

  function flawless_default_settings( $flawless ) {

    $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ][ &#x27;physical_address&#x27; ] = array(
      &#x27;label&#x27; =&gt; __( &#x27;Address&#x27;, &#x27;flawless&#x27; ),
      &#x27;type&#x27; =&gt; &#x27;geo_map&#x27;,
      &#x27;locked&#x27; =&gt; &#x27;true&#x27;,
      &#x27;description&#x27; =&gt; __( &#x27;A valid address will allow the theme to retreive geo-coordinates using Google Maps and draw a location map.&#x27;, &#x27;flawless&#x27; )
    );

    $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ][ &#x27;phone_number&#x27; ] = array(
      &#x27;label&#x27; =&gt; __( &#x27;Phone Number&#x27;, &#x27;flawless&#x27; ),
      &#x27;locked&#x27; =&gt; &#x27;true&#x27;
    );

    return $flawless;

  }

  function flawless_update_settings( $flawless ) {

    //** Set coordinates for Business Card Info */
    $coordinates = Flawless::geo_locate_address( $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ][ &#x27;physical_address&#x27; ] );

    $flawless[ &#x27;business_card&#x27; ][ &#x27;system&#x27; ][ &#x27;latitude&#x27; ] = $coordinates-&gt;longitude;
    $flawless[ &#x27;business_card&#x27; ][ &#x27;system&#x27; ][ &#x27;longitude&#x27; ] = $coordinates-&gt;latitude;

    return $flawless;

  }

  function widgets_init() {

    Flawless::console_log( &#x27;P: Widget Registered: Flawless_Widget_Business_Card&#x27; );

    register_widget( &quot;Flawless_Widget_Business_Card&quot; );

  }

  function flawless_option_tabs( $tabs ) {

    $tabs[ &#x27;options_ui_business_card&#x27; ] = array(
      &#x27;label&#x27; =&gt; __( &#x27;Business Info&#x27;, &#x27;flawless&#x27; ),
      &#x27;id&#x27; =&gt; &#x27;options_ui_business_card&#x27;,
      &#x27;position&#x27; =&gt; 30,
      &#x27;callback&#x27; =&gt; array( &#x27;flawless_business_card&#x27;, &#x27;options_ui_business_card&#x27; )
    );

    return $tabs;

  }

  /**
   * Adds &quot;Business Info&quot; tab to the Header configuration.
   *
   * @since Flawless 1.0
   */
  function flawless_option_header_elements( $tabs ) {
    global $flawless;

    $tabs[ &#x27;business&#x27; ] = array(
      &#x27;label&#x27; =&gt; __( &#x27;Business Info&#x27;, &#x27;flawless&#x27; ),
      &#x27;id&#x27; =&gt; &#x27;header-business-card&#x27;,
      &#x27;name&#x27; =&gt; &#x27;flawless_settings[disabled_theme_features][header-business-card]&#x27;,
      &#x27;position&#x27; =&gt; 60,
      &#x27;setting&#x27; =&gt; $flawless[ &#x27;disabled_theme_features&#x27; ][ &#x27;header-business-card&#x27; ],
      &#x27;toggle_label&#x27; =&gt; __( &#x27;Disable the header &lt;b&gt;Caller Card&lt;/b&gt; section.&#x27;, &#x27;flawless&#x27; ),
      &#x27;callback&#x27; =&gt; array( &#x27;flawless_business_card&#x27;, &#x27;header_business_card_options&#x27; )
    );

    return $tabs;

  }

  /**
   * Render contents of the &quot;Business Info&quot; settings in Header
   *
   * @since Flawless 1.0
   */
  function header_business_card_options( $flawless ) {

    $header_options = ( is_array( $flawless[ &#x27;business_card&#x27; ][ &#x27;header&#x27; ] ) ? $flawless[ &#x27;business_card&#x27; ][ &#x27;header&#x27; ] : array() );
    $main_options = ( is_array( $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ] ) ? $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ] : array() );

    $social_icons = flawless_footer_follow( $flawless, array( &#x27;return_raw&#x27; =&gt; true ) );

    if ( count( $social_icons ) &gt; 0 ) {
      $main_options[ &#x27;social_icons&#x27; ][ &#x27;label&#x27; ] = __( &#x27;Social Media Icons&#x27;, &#x27;flawless&#x27; );
    }

    //** Cycle through saved attributes, to maintain order, and remove any that are no longer in main list */
    foreach ( $header_options as $slug =&gt; $selected ) {
      if ( !in_array( $slug, array_keys( $main_options ) ) ) {
        unset( $header_options[ $slug ] );
      } else {
        $header_options[ $slug ] = $main_options[ $slug ];

        if ( $selected[ &#x27;enable&#x27; ] == &#x27;true&#x27; ) {
          $header_options[ $slug ][ &#x27;enable&#x27; ] = &#x27;true&#x27;;
        }
      }
    }

    //** Cycle through main options, and add any to array that are not already there */
    foreach ( $main_options as $slug =&gt; $data ) {
      if ( !in_array( $slug, array_keys( $header_options ) ) ) {
        $header_options[ $slug ] = $data;
      }
    }


    ?&gt;

    &lt;p&gt;&lt;?php _e( &#x27;Fields to Display:&#x27;, &#x27;flawless&#x27; ); ?&gt;&lt;/p&gt;
    &lt;div class=&quot;flawless_sortable_wrapper flawless_bc_options wp-tab-panel&quot;&gt;
    &lt;ul class=&quot;flawless_sortable_attributes&quot;&gt;
    &lt;?php foreach ( $header_options as $slug =&gt; $data ) { ?&gt;
      &lt;li&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;flawless_settings[business_card][header][&lt;?php echo $slug; ?&gt;][enable]&quot; value=&quot;false&quot;/&gt;
      &lt;input class=&quot;checkbox&quot; type=&quot;checkbox&quot; &lt;?php checked( $header_options[ $slug ][ &#x27;enable&#x27; ], &#x27;true&#x27; ) ?&gt; id=&quot;header_business_card_&lt;?php echo $slug; ?&gt;&quot; name=&quot;flawless_settings[business_card][header][&lt;?php echo $slug; ?&gt;][enable]&quot; value=&quot;true&quot;/&gt;
      &lt;label for=&quot;header_business_card_&lt;?php echo $slug; ?&gt;&quot;&gt;&lt;?php echo $data[ &#x27;label&#x27; ]; ?&gt;&lt;/label&gt;
    &lt;/li&gt;
    &lt;?php } ?&gt;
    &lt;/ul&gt;
    &lt;/div&gt;

  &lt;?php

  }

  /**
   *
   * @param $flawless
   */
  function options_ui_business_card( $flawless ) {
    /** Determine if business_card option doesn&#x27;t exist some way we set default settings */
    if ( empty( $flawless[ &#x27;business_card&#x27; ] ) ) {
      $flawless = self::flawless_default_settings( $flawless );
    }
    ?&gt;

    &lt;div class=&quot;tab_description&quot;&gt;&lt;?php _e( &#x27;&#x27;, &#x27;flawless&#x27; ); ?&gt;&lt;/div&gt;

    &lt;table class=&quot;form-table&quot;&gt;
      &lt;tbody&gt;
        &lt;tr valign=&quot;top&quot;&gt;
          &lt;th&gt;&lt;?php _e( &#x27;Business Info&#x27;, &#x27;flawless&#x27; ); ?&gt;&lt;/th&gt;
          &lt;td&gt;
            &lt;table class=&quot;widefat wpp_something_advanced_wrapper ud_ui_dynamic_table&quot; sortable_table=&quot;true&quot; allow_random_slug=&quot;false&quot;&gt;
              &lt;tbody&gt;
              &lt;?php foreach ( (array) $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ] as $slug =&gt; $data ) { ?&gt;
                &lt;tr class=&quot;flawless_dynamic_table_row &lt;?php echo( $data[ &#x27;locked&#x27; ] == &#x27;true&#x27; ? &#x27;flawless_locked_row&#x27; : &#x27;&#x27; ); ?&gt;&quot; slug=&quot;&lt;?php echo $slug; ?&gt;&quot; new_row=&quot;false&quot; lock_row=&quot;&lt;?php echo( $data[ &#x27;locked&#x27; ] == &#x27;true&#x27; ? &#x27;true&#x27; : &#x27;false&#x27; ); ?&gt;&quot;&gt;
                  &lt;th&gt;
                    &lt;div class=&quot;delete_icon flawless_delete_row&quot; verify_action=&quot;true&quot;&gt;&lt;/div&gt;
                    &lt;ul class=&quot;flawless_options_wrapper&quot;&gt;
                      &lt;li&gt;
                        &lt;input type=&quot;text&quot; id=&quot;flawless_card_&lt;?php echo $slug; ?&gt;&quot; class=&quot;slug_setter&quot; name=&quot;flawless_settings[business_card][data][&lt;?php echo $slug; ?&gt;][label]&quot; value=&quot;&lt;?php echo $data[ &#x27;label&#x27; ]; ?&gt;&quot;/&gt;
                      &lt;/li&gt;
                    &lt;/ul&gt;
                    &lt;input type=&quot;hidden&quot; class=&quot;slug_setter&quot; name=&quot;flawless_settings[business_card][data][&lt;?php echo $slug; ?&gt;][type]&quot; value=&quot;&lt;?php echo $data[ &#x27;type&#x27; ]; ?&gt;&quot;/&gt;
                    &lt;input type=&quot;hidden&quot; do_not_clone=&quot;true&quot; class=&quot;slug_setter&quot; name=&quot;flawless_settings[business_card][data][&lt;?php echo $slug; ?&gt;][locked]&quot; value=&quot;&lt;?php echo $data[ &#x27;locked&#x27; ]; ?&gt;&quot;/&gt;
                    &lt;input type=&quot;hidden&quot; do_not_clone=&quot;true&quot; class=&quot;slug_setter&quot; name=&quot;flawless_settings[business_card][data][&lt;?php echo $slug; ?&gt;][description]&quot; value=&quot;&lt;?php echo $data[ &#x27;description&#x27; ]; ?&gt;&quot;/&gt;
                  &lt;/th&gt;
                  &lt;td class=&quot;draggable_col&quot;&gt;
                    &lt;input type=&quot;text&quot; id=&quot;flawless_card_&lt;?php echo $slug; ?&gt;&quot; class=&quot;regular-text&quot; name=&quot;flawless_settings[business_card][data][&lt;?php echo $slug; ?&gt;][value]&quot; value=&quot;&lt;?php echo $data[ &#x27;value&#x27; ]; ?&gt;&quot;/&gt;
                    &lt;?php echo( $data[ &#x27;description&#x27; ] ? &#x27;&lt;div class=&quot;description&quot;&gt;&#x27; . $data[ &#x27;description&#x27; ] . &#x27;&lt;/div&gt;&#x27; : &#x27;&#x27; ); ?&gt;
                  &lt;/td&gt;
                &lt;/tr&gt;
              &lt;?php } ?&gt;
              &lt;/tbody&gt;
              &lt;tfoot&gt;
                &lt;tr&gt;
                  &lt;td colspan=&#x27;2&#x27;&gt;&lt;input type=&quot;button&quot; class=&quot;flawless_add_row button-secondary&quot; value=&quot;&lt;?php _e( &#x27;Add Row&#x27;, &#x27;flawless&#x27; ) ?&gt;&quot;/&gt;&lt;/td&gt;
                &lt;/tr&gt;
              &lt;/tfoot&gt;
            &lt;/table&gt;
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;&lt;?php _e( &#x27;Social Media Links&#x27; ); ?&gt;&lt;/th&gt;
          &lt;td&gt;
            &lt;ul class=&quot;social_media_icons&quot;&gt;
              &lt;?php foreach ( flawless_footer_follow( $flawless, array( &#x27;return_raw&#x27; =&gt; true ) ) as $social_key =&gt; $social_row ) { ?&gt;
                &lt;li&gt;
                  &lt;label for=&quot;&lt;?php echo $social_key; ?&gt;&quot;&gt;
                    &lt;img class=&quot;social_media_icon_thumb&quot; src=&quot;&lt;?php echo $social_row[ &#x27;thumb_url&#x27; ]; ?&gt;&quot;/&gt;
                  &lt;/label&gt;
                  &lt;input id=&quot;&lt;?php echo $social_key; ?&gt;&quot; type=&quot;text&quot; class=&quot;flawless_force_http_prefix&quot; name=&quot;flawless_settings[social_icons][&lt;?php echo $social_row[ &#x27;option&#x27; ]; ?&gt;]&quot; value=&quot;&lt;?php echo $social_row[ &#x27;url&#x27; ]; ?&gt;&quot;/&gt;
                  &lt;span class=&quot;label&quot;&gt;&lt;?php echo $social_row[ &#x27;label&#x27; ]; ?&gt;&lt;/span&gt;
                &lt;/li&gt;
              &lt;?php } ?&gt;
            &lt;/ul&gt;

          &lt;/td&gt;
          &lt;/tr&gt;

      &lt;/tbody&gt;
    &lt;/table&gt;


  &lt;?php
  }

}

/**
 * Business Card widget.
 *
 * @since 3.0.0
 */
class Flawless_Widget_Business_Card extends WP_Widget {

  /**
   * Initialize the widget.
   *
   * @since 3.0.0
   */
  function __construct() {

    parent::__construct(
      &#x27;business_card&#x27;,
      __( &#x27;Business Card&#x27;, &#x27;flawless&#x27; ),
      array(
        &#x27;classname&#x27; =&gt; &#x27;business_card&#x27;,
        &#x27;description&#x27; =&gt; __( &#x27;Display business information in a flexible format.&#x27;, &#x27;flawless&#x27; )
      ),
      array(
        &#x27;width&#x27; =&gt; 300
      )
    );

  }

  /**
   * Renders the widget on the front-end.
   *
   * @since 3.0.0
   */
  function widget( $args, $instance ) {
    global $flawless;

    extract( $args );

    if ( empty( $instance ) ) {
      return;
    }

    $html[ ] = $before_widget;

    if ( $instance[ &#x27;widget_title&#x27; ] ) {
      $html[ ] = $before_title . $instance[ &#x27;widget_title&#x27; ] . $after_title;
    }

    $main_data = ( is_array( $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ] ) ? $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ] : array() );

    foreach ( $instance as $slug =&gt; $option ) {

      if ( $option != &#x27;true&#x27; ) {
        continue;
      }

      $classes = array( $slug );

      $data = $main_data[ $slug ];

      $value = $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ][ $slug ][ &#x27;value&#x27; ];
      $label = $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ][ $slug ][ &#x27;label&#x27; ];

      if ( $slug == &#x27;social_icons&#x27; ) {
        $value = flawless_footer_follow();
      }

      if ( empty( $value ) ) {
        continue;
      }

      if ( Flawless::is_url( $value ) ) {
        $value = &#x27;&lt;a class=&quot;business_info_link&quot; href=&quot;&#x27; . $value . &#x27;&quot;&gt;&#x27; . $label . &#x27;&lt;/a&gt;&#x27;;
        $classes[ ] = &#x27;has_link&#x27;;
      }

      $attributes[ ] = &#x27;&lt;p class=&quot;&#x27; . implode( &#x27; &#x27;, (array) $classes ) . &#x27;&quot;&gt;&#x27; . nl2br( do_shortcode( $value ) ) . &#x27;&lt;/p&gt;&#x27;;
    }

    if ( !empty( $attributes ) ) {
      $html[ &#x27;attributes&#x27; ] = &#x27;&lt;address class=&quot;flawless_business_card_items&quot;&gt;&#x27; . implode( &#x27;&#x27;, $attributes ) . &#x27;&lt;/address&gt;&#x27;;
    }

    $html[ ] = $after_widget;

    if ( !empty( $html[ &#x27;attributes&#x27; ] ) ) {
      echo implode( &#x27;&#x27;, $html );
    } else {
      return false;
    }

  }

  /**
   * Handles any special functions when the widget is being updated.
   *
   * @since 3.0.0
   */
  function update( $new_instance, $old_instance ) {
    return $new_instance;
  }

  /**
   * Renders widget UI in control panel.
   *
   *
   * @todo Needs to make use of sortable attributes.
   * @uses $current_screen global variable
   * @since 3.0.0
   */
  function form( $instance = false ) {
    global $flawless;

    if ( $this ) {
      $this_here = $this;
    }

    $widget_options = ( is_array( $instance ) ? $instance : array() );
    $main_options = ( is_array( $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ] ) ? $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ] : array() );

    //** We don&#x27;t want to mix in the title into our array */
    unset( $widget_options[ &#x27;widget_title&#x27; ] );

    //** Cycle through saved attributes, to maintain order, and remove any that are no longer in main list */
    foreach ( $widget_options as $slug =&gt; $selected ) {
      if ( !in_array( $slug, array_keys( $main_options ) ) ) {
        unset( $widget_options[ $slug ] );
      } else {
        $widget_options[ $slug ] = $main_options[ $slug ];
      }
    }

    //** Cycle through main options, and add any to array that are not already there */
    foreach ( $main_options as $slug =&gt; $data ) {
      if ( !in_array( $slug, array_keys( $widget_options ) ) ) {
        $widget_options[ $slug ] = $data;
      }
    }

    $social_icons = flawless_footer_follow( $flawless, array( &#x27;return_raw&#x27; =&gt; true ) );

    if ( count( $social_icons ) &gt; 0 ) {
      $widget_options[ &#x27;social_icons&#x27; ][ &#x27;label&#x27; ] = __( &#x27;Social Media Icons&#x27;, &#x27;flawless&#x27; );
    }

    ?&gt;

    &lt;script type=&quot;text/javascript&quot;&gt;
      jQuery( document ).ready( function () {
        if ( typeof jQuery.fn.sortable == &#x27;function&#x27; ) {
          jQuery( &quot;.flawless_sortable_wrapper&quot; ).each( function () {
            jQuery( &quot;.flawless_sortable_attributes&quot;, this ).sortable();
          } );
        }
      } );
    &lt;/script&gt;

    &lt;p&gt;
      &lt;label for=&quot;&lt;?php echo $this_here-&gt;get_field_id( &#x27;widget_title&#x27; ); ?&gt;&quot;&gt;&lt;?php _e( &#x27;Title:&#x27; ); ?&gt;
        &lt;input class=&quot;widefat&quot; id=&quot;&lt;?php echo $this_here-&gt;get_field_id( &#x27;widget_title&#x27; ); ?&gt;&quot; name=&quot;&lt;?php echo $this_here-&gt;get_field_name( &#x27;widget_title&#x27; ); ?&gt;&quot; type=&quot;text&quot; value=&quot;&lt;?php echo esc_attr( $instance[ &#x27;widget_title&#x27; ] ); ?&gt;&quot;/&gt;&lt;/label&gt;
    &lt;/p&gt;

    &lt;p&gt;&lt;?php _e( &#x27;Fields to Display:&#x27;, &#x27;flawless&#x27; ); ?&gt;&lt;/p&gt;
    &lt;div class=&quot;flawless_sortable_wrapper flawless_bc_options wp-tab-panel&quot;&gt;
    &lt;ul class=&quot;flawless_sortable_attributes&quot;&gt;
    &lt;?php foreach ( $widget_options as $slug =&gt; $data ) { ?&gt;
      &lt;li&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;&lt;?php echo $this_here-&gt;get_field_name( $slug ); ?&gt;&quot; value=&quot;false&quot;/&gt;
      &lt;input class=&quot;checkbox&quot; type=&quot;checkbox&quot; &lt;?php checked( $instance[ $slug ], &#x27;true&#x27; ) ?&gt; id=&quot;&lt;?php echo $this_here-&gt;get_field_id( $slug ); ?&gt;&quot; name=&quot;&lt;?php echo $this_here-&gt;get_field_name( $slug ); ?&gt;&quot; value=&quot;true&quot;/&gt;
      &lt;label for=&quot;&lt;?php echo $this_here-&gt;get_field_id( $slug ); ?&gt;&quot;&gt;&lt;?php echo $data[ &#x27;label&#x27; ]; ?&gt;&lt;/label&gt;
    &lt;/li&gt;
    &lt;?php } ?&gt;
    &lt;/ul&gt;
    &lt;/div&gt;

  &lt;?php

  }

}

/**
 * Display Folow icons in the footer if required data is inputed
 *
 *
 */
if ( !function_exists( &#x27;flawless_footer_follow&#x27; ) ) {
  function flawless_footer_follow( $flawless = false, $args = false ) {

    if ( !$flawless ) {
      global $flawless;
    }

    $defaults = array(
      &#x27;return_raw&#x27; =&gt; false,
      &#x27;return_array&#x27; =&gt; false,
      &#x27;echo&#x27; =&gt; false
    );

    $args = wp_parse_args( $args, $defaults );

    $template_dir = get_bloginfo( &#x27;template_url&#x27; );

    $icons[ &#x27;twitter&#x27; ][ &#x27;icon&#x27; ] = &#x27;/img/follow_t.png&#x27;;
    $icons[ &#x27;twitter&#x27; ][ &#x27;url&#x27; ] = $flawless[ &#x27;social_icons&#x27; ][ &#x27;twitter&#x27; ];
    $icons[ &#x27;twitter&#x27; ][ &#x27;option&#x27; ] = &#x27;twitter&#x27;;
    $icons[ &#x27;twitter&#x27; ][ &#x27;label&#x27; ] = &#x27;Twitter&#x27;;

    $icons[ &#x27;facebook&#x27; ][ &#x27;icon&#x27; ] = &#x27;/img/follow_f.png&#x27;;
    $icons[ &#x27;facebook&#x27; ][ &#x27;url&#x27; ] = $flawless[ &#x27;social_icons&#x27; ][ &#x27;facebook&#x27; ];
    $icons[ &#x27;facebook&#x27; ][ &#x27;option&#x27; ] = &#x27;facebook&#x27;;
    $icons[ &#x27;facebook&#x27; ][ &#x27;label&#x27; ] = &#x27;Facebook&#x27;;

    $icons[ &#x27;linkedin&#x27; ][ &#x27;icon&#x27; ] = &#x27;/img/follow_in.png&#x27;;
    $icons[ &#x27;linkedin&#x27; ][ &#x27;url&#x27; ] = $flawless[ &#x27;social_icons&#x27; ][ &#x27;linkedin&#x27; ];
    $icons[ &#x27;linkedin&#x27; ][ &#x27;option&#x27; ] = &#x27;linkedin&#x27;;
    $icons[ &#x27;linkedin&#x27; ][ &#x27;label&#x27; ] = &#x27;LinkedIn&#x27;;

    $icons[ &#x27;rss&#x27; ][ &#x27;icon&#x27; ] = &#x27;/img/follow_rss.png&#x27;;
    $icons[ &#x27;rss&#x27; ][ &#x27;url&#x27; ] = $flawless[ &#x27;social_icons&#x27; ][ &#x27;rss&#x27; ];
    $icons[ &#x27;rss&#x27; ][ &#x27;option&#x27; ] = &#x27;rss&#x27;;
    $icons[ &#x27;rss&#x27; ][ &#x27;label&#x27; ] = &#x27;RSS&#x27;;

    $icons[ &#x27;youtube&#x27; ][ &#x27;icon&#x27; ] = &#x27;/img/follow_y.png&#x27;;
    $icons[ &#x27;youtube&#x27; ][ &#x27;url&#x27; ] = $flawless[ &#x27;social_icons&#x27; ][ &#x27;youtube&#x27; ];
    $icons[ &#x27;youtube&#x27; ][ &#x27;option&#x27; ] = &#x27;youtube&#x27;;
    $icons[ &#x27;youtube&#x27; ][ &#x27;label&#x27; ] = &#x27;YouTube&#x27;;

    $icons = apply_filters( &#x27;flawless_social_icons&#x27;, $icons );

    foreach ( $icons as $network =&gt; $data ) {

      $thumb_url = $template_dir . $data[ &#x27;icon&#x27; ];

      $icons[ $network ][ &#x27;thumb_url&#x27; ] = $thumb_url;

      if ( !empty( $data[ &#x27;url&#x27; ] ) ) {
        $html[ ] = &#x27;&lt;a href=&quot;&#x27; . $data[ &#x27;url&#x27; ] . &#x27;&quot;&gt;&lt;img class=&quot;flawless_social_link&quot; src=&quot;&#x27; . $thumb_url . &#x27;&quot; /&gt;&lt;/a&gt;&#x27;;
      }

    }

    if ( $args[ &#x27;return_raw&#x27; ] ) {
      return $icons;
    }

    if ( !is_array( $icons ) ) {
      return array();
    }

    if ( !is_array( $html ) ) {
      return array();
    }

    $html = implode( &#x27;&#x27;, $html );

    if ( $args[ &#x27;echo&#x27; ] ) {
      echo $html;
      return;
    }

    if ( $args[ &#x27;return_array&#x27; ] ) {
      return $icons;
    }

    return $html;

  }
}

if ( !function_exists( &#x27;flawless_have_business_card&#x27; ) ) {
  function flawless_have_business_card( $scope = false ) {
    global $flawless;

    if ( !$scope || !is_array( $flawless[ &#x27;business_card&#x27; ][ $scope ] ) ) {
      return;
    }

    $options = $flawless[ &#x27;business_card&#x27; ][ $scope ];
    $main_data = ( is_array( $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ] ) ? $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ] : array() );

    foreach ( $options as $slug =&gt; $data ) {

      $classes = array( $slug );

      if ( $data[ &#x27;enable&#x27; ] != &#x27;true&#x27; ) {
        continue;
      }

      $data = $main_data[ $slug ];

      $value = $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ][ $slug ][ &#x27;value&#x27; ];
      $label = $flawless[ &#x27;business_card&#x27; ][ &#x27;data&#x27; ][ $slug ][ &#x27;label&#x27; ];

      if ( $slug == &#x27;social_icons&#x27; ) {
        $value = flawless_footer_follow();
      }

      if ( empty( $value ) ) {
        continue;
      }

      //** Convert into URL, if a URL is used */
      if ( Flawless::is_url( $value ) ) {
        $value = &#x27;&lt;a class=&quot;business_info_link&quot; href=&quot;&#x27; . $value . &#x27;&quot;&gt;&#x27; . $label . &#x27;&lt;/a&gt;&#x27;;
        $classes[ ] = &#x27;has_link&#x27;;
      }

      $attributes[ ] = &#x27;&lt;li class=&quot;&#x27; . implode( &#x27; &#x27;, (array) $classes ) . &#x27;&quot;&gt;&#x27; . nl2br( do_shortcode( $value ) ) . &#x27;&lt;/li&gt;&#x27;;
    }

    if ( !empty( $attributes ) ) {
      $html[ &#x27;attributes&#x27; ] = &#x27;&lt;ul class=&quot;flawless_business_card_items &#x27; . $scope . &#x27;&quot;&gt;&#x27; . implode( &#x27;&#x27;, $attributes ) . &#x27;&lt;/ul&gt;&#x27;;
    }

    if ( !empty( $html[ &#x27;attributes&#x27; ] ) ) {
      return implode( &#x27;&#x27;, $html );
    } else {
      return false;
    }

  }
}

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>

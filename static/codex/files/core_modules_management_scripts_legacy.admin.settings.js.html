<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>core/modules/management/scripts/legacy.admin.settings.js - wp-flawless</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http://a3d72a45d111006ec192-ec5b80a12b0b09b4d52373336afb4254.r80.cf1.rackcdn.com/usability-dynamics.png" title="wp-flawless"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/API.html">API</a></li>
            
                <li><a href="../classes/Carrington.html">Carrington</a></li>
            
                <li><a href="../classes/Extended_Taxonomies.html">Extended_Taxonomies</a></li>
            
                <li><a href="../classes/Flawless.API.html">Flawless.API</a></li>
            
                <li><a href="../classes/Flawless.Asset.html">Flawless.Asset</a></li>
            
                <li><a href="../classes/Flawless.Branded_Login.html">Flawless.Branded_Login</a></li>
            
                <li><a href="../classes/Flawless.BuddyPress.html">Flawless.BuddyPress</a></li>
            
                <li><a href="../classes/Flawless.Content.html">Flawless.Content</a></li>
            
                <li><a href="../classes/Flawless.Element.html">Flawless.Element</a></li>
            
                <li><a href="../classes/Flawless.Flawless\Shortcode.html">Flawless.Flawless\Shortcode</a></li>
            
                <li><a href="../classes/Flawless.Management.html">Flawless.Management</a></li>
            
                <li><a href="../classes/Flawless.Mobile.html">Flawless.Mobile</a></li>
            
                <li><a href="../classes/Flawless.Navbars.html">Flawless.Navbars</a></li>
            
                <li><a href="../classes/Flawless.Schema.html">Flawless.Schema</a></li>
            
                <li><a href="../classes/Flawless.Settings.html">Flawless.Settings</a></li>
            
                <li><a href="../classes/Flawless.Styles.html">Flawless.Styles</a></li>
            
                <li><a href="../classes/Flawless.Utility.html">Flawless.Utility</a></li>
            
                <li><a href="../classes/Flawless.Widget.html">Flawless.Widget</a></li>
            
                <li><a href="../classes/flawless_wpp_extensions.html">flawless_wpp_extensions</a></li>
            
                <li><a href="../classes/Legacy.html">Legacy</a></li>
            
                <li><a href="../classes/License.html">License</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Log.html">Log</a></li>
            
                <li><a href="../classes/Maintenance.html">Maintenance</a></li>
            
                <li><a href="../classes/Models.html">Models</a></li>
            
                <li><a href="../classes/Module.html">Module</a></li>
            
                <li><a href="../classes/Multisite.html">Multisite</a></li>
            
                <li><a href="../classes/SaaS.html">SaaS</a></li>
            
                <li><a href="../classes/Shortcode.html">Shortcode</a></li>
            
                <li><a href="../classes/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../classes/Template Methods.html">Template Methods</a></li>
            
                <li><a href="../classes/Theme.html">Theme</a></li>
            
                <li><a href="../classes/UI.html">UI</a></li>
            
                <li><a href="../classes/Utility.html">Utility</a></li>
            
                <li><a href="../classes/Views.html">Views</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/API.html">API</a></li>
            
                <li><a href="../modules/Branded Login.html">Branded Login</a></li>
            
                <li><a href="../modules/Carrington.html">Carrington</a></li>
            
                <li><a href="../modules/Carrington Build.html">Carrington Build</a></li>
            
                <li><a href="../modules/carrington-build.html">carrington-build</a></li>
            
                <li><a href="../modules/cfct_build.html">cfct_build</a></li>
            
                <li><a href="../modules/default.html">default</a></li>
            
                <li><a href="../modules/Flawless.html">Flawless</a></li>
            
                <li><a href="../modules/Loader.html">Loader</a></li>
            
                <li><a href="../modules/Log.html">Log</a></li>
            
                <li><a href="../modules/Maintenence.html">Maintenence</a></li>
            
                <li><a href="../modules/Management.html">Management</a></li>
            
                <li><a href="../modules/Multisite.html">Multisite</a></li>
            
                <li><a href="../modules/SaaS.html">SaaS</a></li>
            
                <li><a href="../modules/Services_JSON.html">Services_JSON</a></li>
            
                <li><a href="../modules/Shortcodes.html">Shortcodes</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

Released under the GPL license
http:__www.opensource.org_licenses_gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
http://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

Released under the GPL license
http://www.opensource.org/licenses/gpl-license.php

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https:__github.com_crowdfavorite_wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http:__crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************.html">taxonomy-landing

This file is part of Taxonomy Landing for WordPress
https://github.com/crowdfavorite/wp-taxonomy-landing

Copyright (c) 2009-2012 Crowd Favorite, Ltd. All rights reserved.
http://crowdfavorite.com

**********************************************************************
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**********************************************************************</a></li>
            
                <li><a href="../modules/Theme UI.html">Theme UI</a></li>
            
                <li><a href="../modules/UI.html">UI</a></li>
            
                <li><a href="../modules/UsabilityDynamics.html">UsabilityDynamics</a></li>
            
                <li><a href="../modules/Utility.html">Utility</a></li>
            
                <li><a href="../modules/Views.html">Views</a></li>
            
                <li><a href="../modules/WP-Property.html">WP-Property</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: core/modules/management/scripts/legacy.admin.settings.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * WP Property Settings / Upgrade / New Installation
 *
 * = To Do =
 * - Add System Attribute / Geolocation Attribute notice. (wpp.strings.protected_geolocation_slug)
 *
 * @updated 2.0
 */


/* If jQuery exists */
if( typeof jQuery === &#x27;function&#x27; ) {

  /* Initial wpp object (new or extended) */
  wpp = jQuery.extend( true, {
    screen: &#x27;settings&#x27;,
    settings_ui: {
      animation: false,
      view_model: false,
      save_button: jQuery( &#x27;input.wpp_save_settings&#x27; ),
      wrapper: jQuery( &#x27;.wpp-ajax-container&#x27; ),
      sidebar: jQuery( &#x27;.wpp_ui_sidebar&#x27; ),
      section_links: jQuery( &#x27;ul.wpp_settings &gt; li &gt; a.wpp_link&#x27; ).css( &#x27;opacity&#x27;, 0.3 ),
      loaded_tabs: {}
    }
  }, typeof wpp === &#x27;object&#x27; ? wpp : {} );


  /**
   * Initializer
   *
   */
  jQuery( document ).ready( function() {
    &#x27;use strict&#x27;;wpp.log( &#x27;document::ready&#x27;, arguments );

    /* Show message if needed. */
    if( typeof wpp.request.message !== &#x27;undefined&#x27; ) {
      switch( wpp.request.message ) {
        case &#x27;settings_updated&#x27;:
        case &#x27;backup_restored&#x27;:
          wpp.settings_ui.core_notice( wpp.strings[ wpp.request.message ] );
          break;
      }
    }

    /**
     * Handles form saving
     */
    jQuery( &#x27;form.wpp_settings&#x27; ).submit( function( ) {

      /** Don&#x27;t allow to submit form before View Model initialization. */
      if( !wpp.settings_ui.view_model ) {
        return false;
      }

    });

    /** Load all sections */
    wpp.settings_ui.load_sections();

  });


  /**
   *  Fired after Knockout applyBingings
   *
   */
  jQuery(document).bind( &#x27;view_model::wpp_settings::init&#x27;, function( e, view_model ) {

    /**
     * Mass set property type ( Property types section )
     */
    jQuery( &quot;#wpp_ajax_max_set_property_type&quot; ).click( function() {
     if( !confirm( view_model.strings.confirm_type_change ) ) {
       return;
     }
     jQuery.post( ajaxurl, {
       action: &#x27;wpp_ajax_max_set_property_type&#x27;,
       property_type: jQuery( &quot;#wpp_ajax_max_set_property_type_type&quot; ).val()
     }, function( data ) {
       if( data !== &#x27;&#x27; ) {
         jQuery( &quot;#wpp_ajax_max_set_property_type_result&quot; ).show();
         jQuery( &quot;#wpp_ajax_max_set_property_type_result&quot; ).html( data );
       }
     });
    });


    /**
     *
     */
    jQuery( &#x27;.wpp-backup-button span&#x27; ).click( function()  {
      switch( true ) {
        case jQuery( this ).hasClass( &#x27;wpp_restore&#x27; ):
          if( confirm( view_model.strings.restore_backup_confirm ) ) {
            window.location = jQuery( this ).data( &#x27;href&#x27; );
          }
          break;
        case jQuery( this ).hasClass( &#x27;wpp_del&#x27; ):
          if( confirm( wpp.strings.delete_backup_confirm ) ) {
            jQuery.post( ajaxurl, {
              action: &#x27;wpp_delete_option&#x27;,
              option: jQuery( this ).data( &#x27;backup&#x27; )
            });
            jQuery( this ).parent().remove();
          }
          break;
      }
    });


    /**
     * Show settings array
     */
    jQuery( &quot;#wpp_show_settings_array&quot; ).click( function() {
      jQuery( &quot;#wpp_show_settings_array_cancel&quot; ).show();
      jQuery( &quot;#wpp_show_settings_array_result&quot; ).show();
    });

    /**
     * Hide settings array
     */
    jQuery( &quot;#wpp_show_settings_array_cancel&quot; ).click( function() {
      jQuery( &quot;#wpp_show_settings_array_result&quot; ).hide();
      jQuery( this ).hide();
    });

    /**
     * Re-validate all addresses
     */
    jQuery( &quot;#wpp_ajax_revalidate_all_addresses&quot; ).click( function() {

      jQuery( this ).val( &#x27;Processing...&#x27; );
      jQuery( this ).attr( &#x27;disabled&#x27;, true );
      jQuery( &#x27;.address_revalidation_status&#x27; ).remove();

      jQuery.post( ajaxurl, {
          action: &#x27;wpp_ajax_revalidate_all_addresses&#x27;
          }, function( data ) {

          jQuery( &quot;#wpp_ajax_revalidate_all_addresses&quot; ).val( &#x27;Revalidate again&#x27; );
          jQuery( &quot;#wpp_ajax_revalidate_all_addresses&quot; ).attr( &#x27;disabled&#x27;, false );

        var message;
        if( data.success == &#x27;true&#x27; ) {
          message = &quot;&lt;div class=&#x27;address_revalidation_status updated fade&#x27;&gt;&lt;p&gt;&quot; + data.message + &quot;&lt;/p&gt;&lt;/div&gt;&quot;;
        } else {
          message = &quot;&lt;div class=&#x27;address_revalidation_status error fade&#x27;&gt;&lt;p&gt;&quot; + data.message + &quot;&lt;/p&gt;&lt;/div&gt;&quot;;
        }

          jQuery( message ).insertAfter( &quot;h2&quot; );
        }, &#x27;json&#x27; );
    });

    /**
     * Show property query
     */
    jQuery( &quot;#wpp_ajax_property_query&quot; ).click( function() {

      var property_id = jQuery( &quot;#wpp_property_class_id&quot; ).val();

      jQuery( &quot;#wpp_ajax_property_result&quot; ).html( &quot;&quot; );

      jQuery.post( ajaxurl, {
          action: &#x27;wpp_ajax_property_query&#x27;,
          property_id: property_id
        }, function( data ) {
          jQuery( &quot;#wpp_ajax_property_result&quot; ).show();
          jQuery( &quot;#wpp_ajax_property_result&quot; ).html( data );
          jQuery( &quot;#wpp_ajax_property_query_cancel&quot; ).show();

        });

    });

    /**
     * Show image data
     */
    jQuery( &quot;#wpp_ajax_image_query&quot; ).click( function() {

      var image_id = jQuery( &quot;#wpp_image_id&quot; ).val();

      jQuery( &quot;#wpp_ajax_image_result&quot; ).html( &quot;&quot; );

      jQuery.post( ajaxurl, {
          action: &#x27;wpp_ajax_image_query&#x27;,
          image_id: image_id
        }, function( data ) {
          jQuery( &quot;#wpp_ajax_image_result&quot; ).show();
          jQuery( &quot;#wpp_ajax_image_result&quot; ).html( data );
          jQuery( &quot;#wpp_ajax_image_query_cancel&quot; ).show();

        });

    });

    /**
     * Hide property query
     */
    jQuery( &quot;#wpp_ajax_property_query_cancel&quot; ).click( function() {
      jQuery( &quot;#wpp_ajax_property_result&quot; ).hide();
      jQuery( this ).hide();
    });

    /**
     * Hide image query
     */
    jQuery( &quot;#wpp_ajax_image_query_cancel&quot; ).click( function() {
      jQuery( &quot;#wpp_ajax_image_result&quot; ).hide();
      jQuery( this ).hide();
    });

    /**
     * Clear Cache
     */
    jQuery( &quot;#wpp_clear_cache&quot; ).click( function() {
      jQuery( &#x27;.clear_cache_status&#x27; ).remove();
      jQuery.post( ajaxurl, {
          action: &#x27;wpp_ajax_clear_cache&#x27;
        }, function( data ) {
        var message = &quot;&lt;div class=&#x27;clear_cache_status updated fade&#x27;&gt;&lt;p&gt;&quot; + data + &quot;&lt;/p&gt;&lt;/div&gt;&quot;;
          jQuery( message ).insertAfter( &quot;h2&quot; );
        });
    });
  });


  /**
   * Initializes Settings MVVM View Model
   *
   * @author peshkov@UD
   */
  wpp.settings_ui.set_view_model = function() {

    /** view_model should initialized only at once. */
    if( wpp.settings_ui.view_model ) {
      return false;
    }

    /** Set specific model&#x27;s data which will be extended by ko.view_model */
    var model = {

      wpp_model: function( data ) {
        return jQuery.extend( {
          &#x27;developer_mode&#x27;: wpp.developer_mode,
          &#x27;build_mode&#x27;: wpp.build_mode,
          &#x27;show_ud_log&#x27;: wpp.show_ud_log,
          &#x27;disable_automatic_feature_update&#x27;: wpp.disable_automatic_feature_update,
          &#x27;disable_wordpress_postmeta_cache&#x27;: wpp.disable_wordpress_postmeta_cache,
          &#x27;disable_legacy_detailed&#x27;: wpp.disable_legacy_detailed,
          &#x27;do_not_automatically_regenerate_thumbnails&#x27;: wpp.do_not_automatically_regenerate_thumbnails,
          &#x27;load_scripts_everywhere&#x27;: wpp.load_scripts_everywhere,
          &#x27;do_not_load_theme_specific_css&#x27;: wpp.do_not_load_theme_specific_css,
          &#x27;customer_key&#x27;: wpp._instance.customer_key ? wpp._instance.customer_key : null,
          &#x27;api_key&#x27;: wpp._instance.api_key ? wpp._instance.api_key : null,
          &#x27;site_uid&#x27;: wpp._instance.site_uid ? wpp._instance.site_uid : null,
          &#x27;public_key&#x27;: wpp._instance.public_key ? wpp._instance.public_key : null,
          &#x27;customer_name&#x27;: null,
          &#x27;customer_name_error&#x27;: wpp.strings.customer_name_is_undefined,
          &#x27;message&#x27;: null, /* Latest message set by SaaS server */
          &#x27;splash&#x27;: null
        }, typeof data === &#x27;object&#x27; ? data : {} );
      },

      global: {

        attribute_classification: function( data ) {
          return ko.mapping.fromJS( jQuery.map( data, function(value, data) {
            value.admin = jQuery.map( value.admin, function( value, data ){
              return {slug: data, label: value};
            });
            value.search = jQuery.map( value.search, function( value, data ){
              return {slug: data, label: value};
            });
            value.slug = data;
            value.description = typeof value.description !== &#x27;undefined&#x27; ? value.description : &#x27;&#x27;;
            return value;
          } ) );
        },

        property_types: function( data ) {
          var self = this;
          data = data ? data : [];
          data = ko.utils.arrayMap( data, function( d ){
            d.new_item = false;
            return new self._property_type( d );
          });
          return ko.mapping.fromJS(data);
        },

        _property_type: function ( args ) {
          var self = this;

          var args = jQuery.extend( true, {
            label: wpp.strings.new_property_type,
            slug: &#x27;new_listing_type&#x27;,
            new_item: true,
            show_advanced_settings : false,
            meta: {
              &#x27;for_sale&#x27; : false,
              &#x27;for_rent&#x27; : false,
              &#x27;by_owner&#x27; : false
            },
            settings: {
              &#x27;geolocatable&#x27; : false,
              &#x27;searchable&#x27; : false,
              &#x27;hierarchical&#x27; : false
            },
            hidden_attributes: [],
            property_inheritance: [],
            toggle_settings: function( self, event ) {
              self.show_advanced_settings( !self.show_advanced_settings() );
            }

          } , typeof args === &#x27;object&#x27; ? args : {} );

          args = ud.apply_filter( &#x27;view_model::wpp_settings::_property_type&#x27;, args );

          jQuery.each( args, function( i, e ) {
            if( typeof e === &#x27;function&#x27; ) self[i] = e;
            else if( typeof e === &#x27;object&#x27; &amp;&amp; typeof e.length !== &#x27;undefined&#x27; ) self[i] = ko.observableArray( e );
            else self[i] = ko.observable( e );
          } );
        },

        image_sizes: function ( args ) {
          var self = this;
          args = jQuery.map( args, function( data, slug ){
            data.slug = slug;
            return jQuery.extend( { width: &#x27;0&#x27;, height: &#x27;0&#x27; }, data );
          } );
          return ko.mapping.fromJS ( args.sort( function(a, b){ return !a.built_in-!b.built_in; } ) );
        },

        _image_size: function( args ) {
          var self = this;
          args = jQuery.extend( true, {
            built_in: false,
            slug:&#x27;&#x27;,
            width:&#x27;0&#x27;,
            height:&#x27;0&#x27;
          }, typeof args === &#x27;object&#x27; ? args : {} );
          for( var i in args ) self[i] = ko.observable( args[i] );
        }
      },

      /**
       * Generates Developer keys.
       * Used on Advanced tab
       *
       * @see core/ui/templates/advanced.php
       */
      generate: {
        api_key: function( self ) {
          if( self.saas.id ) {
            wpp.saas.emit( self.saas.update_trigger, {&#x27;key&#x27;: &#x27;api_key&#x27;, &#x27;path&#x27;: &#x27;wpp_model&#x27;} );
          }
        },
        site_uid: function( self ) {
          wpp.saas.emit( self.saas.update_trigger, {&#x27;key&#x27;: &#x27;site_uid&#x27;, &#x27;path&#x27;: &#x27;wpp_model&#x27;} );
        },
        public_key: function( self ) {
          wpp.saas.emit( self.saas.update_trigger, {&#x27;key&#x27;: &#x27;public_key&#x27;, &#x27;path&#x27;: &#x27;wpp_model&#x27;} );
        }
      },

      /**
       * Clear all activity logs.
       * Used on Logs tab.
       *
       * @see core/ui/interfaces/log.interface
       */
      clear_logs: function( self, item ) {
        if( typeof self !== &#x27;object&#x27; || typeof item === &#x27;undefined&#x27; || !confirm( self.strings.are_you_sure ) ) {
          return;
        }
        /** Set arguments */
        var args = { &#x27;action&#x27;: &#x27;wpp_clear_logs&#x27; };
        if ( typeof item === &#x27;object&#x27; &amp;&amp; typeof item.id !== &#x27;undefined&#x27; ) {
          args.id = item.id;
        }
        jQuery.post( ajaxurl, args, function( data ) {
          if( typeof data[0] !== &#x27;undefined&#x27; &amp;&amp; parseInt( data[0] ) &gt; 0 ) {
            if( typeof args.id !== &#x27;undefined&#x27; ) {
              self.global.activity_logs.remove( item );
            } else {
              self.global.activity_logs.removeAll();
            }
          } else {
            wpp.settings_ui.core_notice( self.strings.error_on_log_removing, &#x27;wpp_error&#x27; );
          }
        }, &#x27;json&#x27; );
      }

    };

    /** Adds ability to handle model&#x27;s additional data. Can be used by Premium Features */
    model = ud.apply_filter( &#x27;view_model::wpp_settings::create&#x27;, model );

    wpp.settings_ui.view_model = ko.view_model( {
      &#x27;model&#x27;: ( typeof wpp._models !== &#x27;undefined&#x27; &amp;&amp; typeof wpp._models.wpp_settings === &#x27;object&#x27; ) ? wpp._models.wpp_settings : &#x27;wpp_settings&#x27;,
      &#x27;saas&#x27;: {
        &#x27;model&#x27;: &#x27;wpp_settings&#x27;,
        &#x27;screen&#x27;: wpp.screen,
        &#x27;show_updates&#x27;: true,
        &#x27;debug_mode&#x27;: wpp.developer_mode,
        &#x27;path&#x27;: &#x27;wpp_model&#x27;
      },
      &#x27;container&#x27;: wpp.settings_ui.wrapper,
      &#x27;actions&#x27;: {

        &#x27;callback&#x27;: function( error, data ) {
          /* Fatal Errors resulting in no UI */
          if( typeof Error === &#x27;function&#x27; &amp;&amp; error instanceof Error ) {
            /** Prevent Load Timeout Event. Becuase error already exists */
            if( typeof data !== &#x27;undefined&#x27; &amp;&amp; typeof data.timers === &#x27;object&#x27; ) {
              clearTimeout( data.timers.load_timeout );
            }
            if( !jQuery( &#x27;#wpp_fatal_notice&#x27; ).length &gt; 0 ) wpp.settings_ui.wrapper.before( &#x27;&lt;div id=&quot;wpp_fatal_notice&quot;&gt;&lt;/div&gt;&#x27; );
            wpp.settings_ui.wrapper.hide().html(&#x27;&#x27;);
            wpp.settings_ui.sidebar.css( &#x27;opacity&#x27;, 0.3 );
            wpp.fatal_notice( {error: error, submit: this, target: jQuery( &#x27;#wpp_fatal_notice&#x27; )} );
            wpp.log( error );
            return false;
          }
          return data;
        },

        /* Automatically called on view_model applying */
        &#x27;init&#x27;: function( self ) {
          /* Always do emit first time before subscribe! Because subscribe could be never fired! */
          if( typeof self.saas._observable_caller === &#x27;object&#x27; ) {
            jQuery.each( self.saas._observable_caller, function( key, obj ) {
              switch( obj.key ) {
                case &#x27;customer_key&#x27;:
                  if( obj.value() !== null ) {
                    wpp.saas.emit( self.saas.update_trigger, {&#x27;key&#x27;: obj.key, &#x27;value&#x27;: obj.value(), &#x27;path&#x27;: obj.path} );
                  }
                  break;
              }
            } );
          }
          /* We run Sammy when everything ( interfaces ) is ready */
          wpp.settings_ui.router.run();
          /* Adds ability to add hooks here. Also Can be used by Premium Features */
          jQuery( document ).trigger( &#x27;view_model::wpp_settings::init&#x27;, self );
        },

        /* Called when data is updated by SaaS */
        &#x27;saas_update_on&#x27;: function ( self, data ) {
          switch( data.key ) {
            /* Check customer key */
            case &#x27;customer_key&#x27;:
              if( data.success ) {
                self.wpp_model.customer_name( data.customer_name );
                self.wpp_model.customer_name_error( null );
              } else {
                self.wpp_model.customer_name( null );
                self.wpp_model.customer_name_error( data.value === &#x27;&#x27; ? wpp.strings.customer_name_is_undefined : data.message );
              }
              break;

          }
        },

        /* Called if SaaS connection is not established */
        &#x27;saas_ignored&#x27;: function() {
          wpp.core_notice( &#x27;WP-Property SaaS connection is not established. Some functionality is not available.&#x27;, &#x27;wpp_error&#x27; );
        }

      },
      &#x27;instance&#x27;: model
    } );

    /* Show sidebar */
    wpp.settings_ui.sidebar.show();

    if( wpp.settings_ui.view_model ) {
      /** Init pagination between tabs */
      wpp.settings_ui.set_sticky_sidebar();
    } else {
      wpp.settings_ui.wrapper.html( &#x27;Error occurred on page loading&#x27; );
    }

  };


  /**
   * Pagination.
   * History implementation.
   *
   * @author peshkov@UD
   */
  wpp.settings_ui.router = new Sammy( function() {

    this.home = location.href;

    this.get( &#x27;#:ui_section&#x27;, function() {
      var self = this;

      var breadcrumb = jQuery( &#x27;.wpp_section_title&#x27;, &#x27;.wpp_section_title_wrap&#x27; );
      if ( breadcrumb.length &gt; 0 ) breadcrumb.empty().parent().hide();

      /** Set current section in form data to have ability to load the current section after save setting */
      if( jQuery( &#x27;input[name=&quot;current_section&quot;]&#x27; ).length &gt; 0 ) {
        jQuery( &#x27;input[name=&quot;current_section&quot;]&#x27; ).val( self.params.ui_section );
      }
      /** Open called section */
      if ( !wpp.settings_ui.animation ) {
        wpp.settings_ui.animation = true;
        jQuery( &#x27;.wpp_settings li a.wpp_link&#x27; ).parent().removeClass(&#x27;wpp_current&#x27;);
        jQuery.each( wpp.settings_ui.loaded_tabs, function( i, e ) {
          e = jQuery( &#x27;.wpp_section_&#x27; + i, wpp.settings_ui.wrapper );
          jQuery( e[0] ).fadeOut( 500, function() {
            jQuery( this ).hide();
            if( i === self.params.ui_section ) {
              wpp.settings_ui.animation = true;
              jQuery( this ).fadeIn( 500, function() {
                jQuery( &#x27;.wpp_settings li a.wpp_link[href=&quot;#&#x27;+self.params.ui_section+&#x27;&quot;]&#x27; ).parent().addClass(&#x27;wpp_current&#x27;);
                jQuery( this ).show(500, function(){
                  wpp.settings_ui.animation = false;
                  if( jQuery( &#x27;.wpp_section_title&#x27;, this ).length &gt; 0 &amp;&amp; breadcrumb.length &gt; 0 ) {
                    breadcrumb.html( jQuery( &#x27;.wpp_section_title&#x27;, this ).html() ).parent().show();
                  }
                  jQuery( document ).trigger(self.params.ui_section+&#x27;_show&#x27;, [this]);
                });
              } );
            }
          } );
        } );
      }
    });

    this.get( &#x27;&#x27;, function( self ) {
      if( self.app.home !== location.href ) {
        window.location = location.href;
      } else {
        this.app.runRoute( &#x27;get&#x27;, &#x27;#main&#x27; );
      }
    } );

  });


  /**
   * Load Sections by way of Ajax
   *
   * @version 2.0
   * @author potanin@UD
   */
  wpp.settings_ui.load_sections = function() {

    wpp.settings_ui.wrapper.addClass( &#x27;wpp_ui_loading&#x27; );

    /**
     * For each settings section run GET UI in background
     */
    var items = [];
    wpp.settings_ui.section_links.each( function( k, element ) {
      items[k] = jQuery( element ).data( &#x27;ui&#x27; );
    });

    wpp.ajax( &#x27;get_uis&#x27;, items, function( response ) {

      for ( k in response.uis ){

        /** IE fix */
        if( typeof response.uis[k] !== &#x27;object&#x27; ) continue;

        var item  =  response.uis[k],
            element = wpp.settings_ui.section_links[k],
            section = jQuery( element ).attr( &#x27;href&#x27; ).replace( &#x27;#&#x27;, &#x27;&#x27; );

        if( wpp.settings_ui.loaded_tabs[ section ] ) {return;}

        var html = &#x27;&lt;div class=&quot;wpp_settings_section wpp_section_&#x27; + section + &#x27;&quot;&gt;&#x27; + item.ui + &#x27;&lt;/div&gt;&#x27;;

        wpp.settings_ui.loaded_tabs[ section ] = jQuery( html ).hide();

        /* Show Link as loaded */
        jQuery( element ).css( &#x27;opacity&#x27;, &#x27;1&#x27; );

        wpp.settings_ui.wrapper.append( wpp.settings_ui.loaded_tabs[ section ] );

        jQuery( document ).trigger( &#x27;wpp::&#x27;+section+&#x27;::interface::loaded&#x27; );

      }

      if( jQuery( &#x27;.wpp_settings_section&#x27; ).length === wpp.settings_ui.section_links.length ) {

        /** Init MVVM View Model and do applyBindings */
        wpp.settings_ui.set_view_model();
        /** Add trigger for ability to add addional actions on this event */
        jQuery( document ).trigger( &#x27;wpp::settings_ui::loaded&#x27; );

      }

    });
  };


  /**
   * Inits sticky sidebar
   *
   * @author peshkov@UD
   */
  wpp.settings_ui.set_sticky_sidebar = function( options ) {
    &#x27;use strict&#x27;;

    if( typeof jQuery.prototype.stickySidebar === &#x27;function&#x27; ) {

      /* Set options for stickySidebar */
      var options = jQuery.extend( {
        padding: 28,
        speed: 0,
        on: {
          &#x27;update&#x27; : function( event, data, sTop, origTop ) {
            var e = jQuery( event.currentTarget ),
                f = false;
            if( !e.hasClass( &#x27;sticky-updated&#x27; ) ) {
              e.addClass( &#x27;sticky-updated&#x27; );
              f = true;
            }
            e.css( {&#x27;left&#x27; : 0, &#x27;right&#x27; : 0, &#x27;width&#x27; : &#x27;auto&#x27;} );
            if( origTop &lt; sTop ) {
              jQuery( &#x27;.wpp_screen_icon&#x27;, e ).hide();
              jQuery( &#x27;.wpp_title_wrap&#x27;, e ).css( { &#x27;opacity&#x27; : 0.5 } );
              jQuery( &#x27;.wpp-title&#x27;, e ).css( { &#x27;font-size&#x27; : &#x27;18px&#x27; } );
              e.css( {&#x27;paddingTop&#x27; : &#x27;4px&#x27;, &#x27;paddingBottom&#x27; : &#x27;4px&#x27;} );
            } else if ( !f ) {
              jQuery( &#x27;.wpp_screen_icon&#x27;, e ).show();
              jQuery( &#x27;.wpp_title_wrap&#x27;, e ).css( { &#x27;opacity&#x27; : 1 } );
              jQuery( &#x27;.wpp-title&#x27;, e ).css( { &#x27;font-size&#x27; : &#x27;23px&#x27; } );
              e.css( {&#x27;paddingTop&#x27; : &#x27;20px&#x27;, &#x27;paddingBottom&#x27; : &#x27;20px&#x27;} );
            }
          },
          &#x27;remove&#x27; : function( event ) {
            var e = jQuery( event.currentTarget );
            e.removeClass( &#x27;sticky-updated&#x27; );
          }
        }
      }, typeof options === &#x27;object&#x27; ? options : {} );

      jQuery( &#x27;.wpp-ui-header&#x27; ).stickySidebar( options );

      /* Remove stickySidebar functionality if Contextual help is opened to avoid bugs. peshkov@UD */
      jQuery( document ).bind( &#x27;contextual-help-link::toggle&#x27;, function( event, isHidden ) {
        jQuery( &#x27;.wpp-ui-header&#x27; ).stickySidebar( &#x27;remove&#x27; );
        setTimeout( function() {
          if( jQuery( &#x27;#screen-meta&#x27; ).is( &#x27;:hidden&#x27; ) ) {
            jQuery( &#x27;.wpp-ui-header&#x27; ).stickySidebar( options );
          }
        }, 500 );
      } );

    }
  };


  /**
   * Display a full-width notice.
   *
   */
  wpp.settings_ui.core_notice = function( message, type ) {
    &#x27;use strict&#x27;;wpp.log( &#x27;wpp.settings_ui.core_notice()&#x27;, arguments );
    wpp.core_notice( message, ( typeof type !== &#x27;undefined&#x27; ? type : &#x27;wpp_updated&#x27; ), true );
  };

}


    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
